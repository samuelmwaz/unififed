<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Unified</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.6/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --gold: #F0C040;
            --gold-light: #F7DC80;
            --gold-dark: #C49B1A;
            --ink: #0D1117;
            --ink-soft: #1A2232;
            --surface: #141B27;
            --surface-raised: #1E2B3C;
            --surface-high: #253447;
            --text-primary: #EDF2F7;
            --text-muted: #7A90A8;
            --text-dim: #4A607A;
            --accent-teal: #2DD4BF;
            --accent-orange: #F97316;
            --success: #34D399;
            --danger: #F87171;
            --radius: 16px;
            --radius-sm: 10px;
            --radius-xs: 6px;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'DM Sans', sans-serif; background: #060B14; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        .app-shell { width: 100%; max-width: 430px; min-height: 100vh; background: var(--ink); display: flex; flex-direction: column; position: relative; overflow: hidden; }
        .app-shell::before { content: ''; position: fixed; top: -80px; left: 50%; transform: translateX(-50%); width: 300px; height: 300px; background: radial-gradient(circle, rgba(240,192,64,0.18) 0%, transparent 70%); pointer-events: none; z-index: 0; }
        header { padding: 28px 20px 20px; position: relative; z-index: 10; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .brand { display: flex; align-items: center; gap: 10px; }
        .brand-mark { width: 36px; height: 36px; background: var(--gold); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1rem; color: var(--ink); }
        .brand-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; color: var(--text-primary); letter-spacing: 0.05em; }
        .brand-name span { color: var(--gold); }
        .notif-btn { width: 38px; height: 38px; background: var(--surface-raised); border: 1px solid rgba(255,255,255,0.06); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; font-size: 1.1rem; }
        .notif-dot { position: absolute; top: 6px; right: 6px; width: 8px; height: 8px; background: var(--gold); border-radius: 50%; border: 2px solid var(--ink); }
        .wallet-card { background: linear-gradient(135deg, #1E3A5F 0%, #0D2340 60%, #1A2E50 100%); border-radius: var(--radius); padding: 22px; position: relative; overflow: hidden; border: 1px solid rgba(240,192,64,0.15); }
        .wallet-card::after { content: ''; position: absolute; top: -40px; right: -40px; width: 160px; height: 160px; background: radial-gradient(circle, rgba(240,192,64,0.12) 0%, transparent 70%); }
        .wallet-card::before { content: ''; position: absolute; bottom: -30px; left: -20px; width: 120px; height: 120px; background: radial-gradient(circle, rgba(45,212,191,0.08) 0%, transparent 70%); }
        .wallet-label { font-size: 0.72rem; font-weight: 500; letter-spacing: 0.12em; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; }
        .wallet-balance { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 2.4rem; color: var(--text-primary); line-height: 1; margin-bottom: 18px; }
        .wallet-balance sup { font-size: 1rem; font-weight: 600; color: var(--gold); vertical-align: top; margin-top: 6px; display: inline-block; margin-right: 3px; }
        .wallet-footer { display: flex; align-items: center; justify-content: space-between; }
        .wallet-status { display: flex; align-items: center; gap: 6px; font-size: 0.78rem; color: var(--success); }
        .wallet-status-dot { width: 7px; height: 7px; background: var(--success); border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.6; transform: scale(0.8); } }
        .topup-btn { background: var(--gold); color: var(--ink); border: none; padding: 9px 18px; border-radius: 30px; font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.82rem; cursor: pointer; transition: transform 0.15s, box-shadow 0.15s; }
        .topup-btn:active { transform: scale(0.95); box-shadow: 0 0 20px rgba(240,192,64,0.4); }
        nav { display: flex; padding: 12px 16px; gap: 6px; background: var(--ink); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255,255,255,0.04); }
        .tab-btn { flex: 1; border: none; padding: 10px 4px; cursor: pointer; background: none; font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.68rem; color: var(--text-dim); letter-spacing: 0.06em; transition: color 0.2s; border-radius: var(--radius-xs); }
        .tab-btn.active { color: var(--ink); background: var(--gold); }
        main { flex: 1; }
        .page { display: none; padding: 20px; animation: fadeUp 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 18px; }
        .section-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.05rem; color: var(--text-primary); }
        .section-chip { font-size: 0.7rem; font-weight: 600; padding: 3px 10px; border-radius: 20px; background: rgba(240,192,64,0.12); color: var(--gold); border: 1px solid rgba(240,192,64,0.2); }
        .quick-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .quick-card { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius); padding: 18px 14px; cursor: pointer; transition: transform 0.18s, border-color 0.18s, background 0.18s; position: relative; overflow: hidden; }
        .quick-card:active { transform: scale(0.96); }
        .quick-card:hover { border-color: rgba(240,192,64,0.3); background: var(--surface-raised); }
        .quick-card-icon { font-size: 1.6rem; margin-bottom: 10px; display: block; }
        .quick-card-label { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.82rem; color: var(--text-primary); }
        .quick-card-sub { font-size: 0.7rem; color: var(--text-muted); margin-top: 2px; }
        .quick-card-arrow { position: absolute; bottom: 12px; right: 14px; color: var(--text-dim); font-size: 0.9rem; }
        .info-banner { display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: rgba(45,212,191,0.07); border: 1px solid rgba(45,212,191,0.18); border-radius: var(--radius-sm); margin-bottom: 16px; }
        .info-banner-icon { font-size: 1.2rem; }
        .info-banner-text { font-size: 0.8rem; color: var(--accent-teal); font-weight: 500; flex: 1; }
        .action-row { display: flex; align-items: center; gap: 14px; padding: 16px; background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); cursor: pointer; transition: background 0.18s, border-color 0.18s, transform 0.15s; margin-bottom: 10px; }
        .action-row:active { transform: scale(0.98); }
        .action-row:hover { background: var(--surface-raised); border-color: rgba(240,192,64,0.2); }
        .action-icon-wrap { width: 42px; height: 42px; border-radius: var(--radius-xs); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0; }
        .action-icon-wrap.gold { background: rgba(240,192,64,0.12); }
        .action-icon-wrap.teal { background: rgba(45,212,191,0.10); }
        .action-icon-wrap.orange { background: rgba(249,115,22,0.10); }
        .action-icon-wrap.red { background: rgba(248,113,113,0.10); }
        .action-text { flex: 1; }
        .action-label { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.88rem; color: var(--text-primary); }
        .action-desc { font-size: 0.72rem; color: var(--text-muted); margin-top: 2px; }
        .action-badge { font-size: 0.68rem; font-weight: 600; padding: 3px 9px; border-radius: 20px; }
        .badge-gold { background: rgba(240,192,64,0.15); color: var(--gold); border: 1px solid rgba(240,192,64,0.25); }
        .badge-promo { background: rgba(249,115,22,0.15); color: var(--accent-orange); border: 1px solid rgba(249,115,22,0.25); }
        .badge-new { background: rgba(52,211,153,0.15); color: var(--success); border: 1px solid rgba(52,211,153,0.25); }
        .badge-red { background: rgba(248,113,113,0.15); color: var(--danger); border: 1px solid rgba(248,113,113,0.25); }
        .action-chevron { color: var(--text-dim); font-size: 0.85rem; flex-shrink: 0; }
        .tries-card { background: linear-gradient(135deg, rgba(240,192,64,0.08), rgba(240,192,64,0.03)); border: 1px solid rgba(240,192,64,0.18); border-radius: var(--radius-sm); padding: 14px 16px; display: flex; align-items: center; gap: 14px; margin-bottom: 16px; }
        .tries-counter { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 2rem; color: var(--gold); line-height: 1; }
        .tries-info { flex: 1; }
        .tries-label { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.85rem; color: var(--text-primary); }
        .tries-sub { font-size: 0.72rem; color: var(--text-muted); margin-top: 2px; }
        .tries-dots { display: flex; gap: 5px; }
        .tries-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--gold); transition: background 0.3s; }
        .tries-dot.used { background: var(--surface-high); }
        .footer-note { font-size: 0.72rem; color: var(--text-dim); text-align: center; padding: 20px 20px 30px; line-height: 1.6; }
        .footer-note strong { color: var(--text-muted); }

        /* â”€â”€ MODAL OVERLAY â”€â”€ */
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); z-index: 200; justify-content: center; align-items: flex-end; backdrop-filter: blur(4px); }
        .modal-overlay.open { display: flex; }
        .modal-sheet { background: var(--surface); border-radius: 24px 24px 0 0; padding: 30px 24px; width: 100%; max-width: 430px; border-top: 1px solid rgba(255,255,255,0.08); animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-handle { width: 40px; height: 4px; background: var(--surface-high); border-radius: 2px; margin: 0 auto 20px; }
        .modal-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.1rem; color: var(--text-primary); margin-bottom: 18px; }
        .modal-input { width: 100%; background: var(--ink); border: 1px solid rgba(255,255,255,0.1); border-radius: var(--radius-sm); padding: 14px 16px; font-family: 'Syne', sans-serif; font-size: 1.4rem; font-weight: 700; color: var(--text-primary); margin-bottom: 14px; outline: none; text-align: center; transition: border-color 0.2s; }
        .modal-input:focus { border-color: var(--gold); }
        .modal-input::placeholder { color: var(--text-dim); }
        .quick-amounts { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 18px; }
        .amount-chip { padding: 9px 4px; background: var(--surface-raised); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius-xs); font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.78rem; color: var(--text-muted); cursor: pointer; text-align: center; transition: all 0.15s; }
        .amount-chip:hover, .amount-chip.selected { background: rgba(240,192,64,0.12); color: var(--gold); border-color: rgba(240,192,64,0.3); }
        .modal-confirm-btn { width: 100%; padding: 16px; background: var(--gold); color: var(--ink); border: none; border-radius: var(--radius-sm); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; cursor: pointer; transition: transform 0.15s, box-shadow 0.15s; }
        .modal-confirm-btn:active { transform: scale(0.97); box-shadow: 0 0 24px rgba(240,192,64,0.35); }
        .modal-cancel { display: block; text-align: center; color: var(--text-dim); font-size: 0.82rem; margin-top: 12px; cursor: pointer; }

        /* â”€â”€ TOAST â”€â”€ */
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(80px); background: var(--surface-high); border: 1px solid rgba(255,255,255,0.1); color: var(--text-primary); padding: 12px 22px; border-radius: 30px; font-size: 0.85rem; font-weight: 500; z-index: 9999; transition: transform 0.3s ease; white-space: nowrap; pointer-events: none; }
        .toast.show { transform: translateX(-50%) translateY(0); }

        /* â”€â”€ TICKET FLOW â”€â”€ */
        .ticket-step { display: none; }
        .ticket-step.active { display: block; }
        .qr-viewport { background: var(--ink); border-radius: var(--radius); border: 2px solid rgba(240,192,64,0.25); aspect-ratio: 1; position: relative; overflow: hidden; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; }
        .qr-scan-line { position: absolute; left: 10%; right: 10%; height: 2px; background: linear-gradient(90deg, transparent, var(--gold), transparent); animation: scanLine 2s ease-in-out infinite; top: 50%; }
        @keyframes scanLine { 0% { top: 15%; opacity: 1; } 48% { opacity: 1; } 50% { top: 85%; opacity: 0.3; } 52% { opacity: 1; } 100% { top: 15%; opacity: 1; } }
        .qr-corner { position: absolute; width: 28px; height: 28px; border-color: var(--gold); border-style: solid; }
        .qr-corner.tl { top: 14px; left: 14px; border-width: 3px 0 0 3px; }
        .qr-corner.tr { top: 14px; right: 14px; border-width: 3px 3px 0 0; }
        .qr-corner.bl { bottom: 14px; left: 14px; border-width: 0 0 3px 3px; }
        .qr-corner.br { bottom: 14px; right: 14px; border-width: 0 3px 3px 0; }
        .qr-inner-icon { font-size: 3rem; opacity: 0.18; }
        .qr-hint { text-align: center; font-size: 0.78rem; color: var(--text-muted); margin-bottom: 18px; }
        .sim-scan-btn { width: 100%; padding: 15px; background: rgba(240,192,64,0.1); border: 1.5px dashed rgba(240,192,64,0.4); border-radius: var(--radius-sm); color: var(--gold); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.9rem; cursor: pointer; transition: background 0.2s; margin-bottom: 10px; }
        .sim-scan-btn:active { background: rgba(240,192,64,0.18); }
        .ticket-summary { background: linear-gradient(135deg, #1E3A5F 0%, #0D2340 100%); border: 1px solid rgba(240,192,64,0.2); border-radius: var(--radius); padding: 18px; margin-bottom: 16px; }
        .ticket-route { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .ticket-city { flex: 1; text-align: center; }
        .ticket-city-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; color: var(--text-primary); }
        .ticket-city-label { font-size: 0.62rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.08em; }
        .ticket-arrow { font-size: 1.3rem; color: var(--gold); }
        .ticket-meta { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.06); }
        .ticket-meta-item { text-align: center; }
        .ticket-meta-val { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.88rem; color: var(--gold); }
        .ticket-meta-key { font-size: 0.62rem; color: var(--text-dim); text-transform: uppercase; }
        .momo-providers { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 16px; }
        .momo-option { background: var(--ink); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-sm); padding: 12px 10px; cursor: pointer; text-align: center; transition: all 0.18s; }
        .momo-option:hover, .momo-option.selected { border-color: var(--gold); background: rgba(240,192,64,0.07); }
        .momo-icon { font-size: 1.4rem; margin-bottom: 4px; }
        .momo-name { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.75rem; color: var(--text-primary); }
        .momo-phone-row { display: flex; align-items: center; background: var(--ink); border: 1px solid rgba(255,255,255,0.1); border-radius: var(--radius-sm); padding: 0 14px; margin-bottom: 14px; transition: border-color 0.2s; }
        .momo-phone-row:focus-within { border-color: var(--gold); }
        .phone-prefix { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; color: var(--text-muted); padding: 14px 10px 14px 0; border-right: 1px solid rgba(255,255,255,0.08); margin-right: 12px; }
        .phone-input { flex: 1; background: none; border: none; font-family: 'Syne', sans-serif; font-size: 1rem; font-weight: 600; color: var(--text-primary); padding: 14px 0; outline: none; }
        .phone-input::placeholder { color: var(--text-dim); font-weight: 400; }
        .fare-total { background: rgba(240,192,64,0.06); border: 1px solid rgba(240,192,64,0.15); border-radius: var(--radius-sm); padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .fare-label { font-size: 0.8rem; color: var(--text-muted); }
        .fare-amount { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.2rem; color: var(--gold); }
        .processing-wrap { display: flex; flex-direction: column; align-items: center; padding: 30px 0 10px; }
        .processing-spinner { width: 60px; height: 60px; border: 3px solid rgba(240,192,64,0.15); border-top-color: var(--gold); border-radius: 50%; animation: spin 0.9s linear infinite; margin-bottom: 18px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .processing-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; color: var(--text-primary); margin-bottom: 6px; text-align: center; }
        .processing-sub { font-size: 0.78rem; color: var(--text-muted); text-align: center; }
        .success-tick { width: 64px; height: 64px; background: rgba(52,211,153,0.1); border: 2px solid var(--success); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; margin: 0 auto 16px; }
        .conductor-code-wrap { text-align: center; margin-bottom: 18px; }
        .conductor-code-label { font-size: 0.68rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 8px; }
        .conductor-code { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 2.8rem; letter-spacing: 0.18em; color: var(--gold); background: rgba(240,192,64,0.06); border: 2px solid rgba(240,192,64,0.25); border-radius: var(--radius-sm); padding: 16px 20px; display: inline-block; min-width: 200px; }
        .conductor-code-hint { font-size: 0.72rem; color: var(--text-muted); margin-top: 8px; }
        .boarding-info { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 16px; }
        .boarding-box { background: var(--ink); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius-xs); padding: 12px; text-align: center; }
        .boarding-box-val { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.9rem; color: var(--text-primary); }
        .boarding-box-key { font-size: 0.62rem; color: var(--text-dim); text-transform: uppercase; margin-top: 2px; }
        .code-expires { display: flex; align-items: center; justify-content: center; gap: 6px; font-size: 0.75rem; color: var(--accent-orange); margin-bottom: 18px; }
        .code-expires-dot { width: 6px; height: 6px; background: var(--accent-orange); border-radius: 50%; animation: pulse 1.5s infinite; }

        /* â”€â”€ STATS ROW â”€â”€ */
        .stats-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-box { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); padding: 14px 12px; text-align: center; }
        .stat-value { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.2rem; color: var(--text-primary); }
        .stat-label { font-size: 0.65rem; color: var(--text-dim); margin-top: 3px; text-transform: uppercase; letter-spacing: 0.06em; }

        /* â”€â”€ FORM ELEMENTS â”€â”€ */
        .svc-input { width: 100%; background: var(--ink); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-sm); padding: 13px 15px; font-family: 'DM Sans', sans-serif; font-size: 0.92rem; color: var(--text-primary); margin-bottom: 12px; outline: none; transition: border-color 0.2s; }
        .svc-input:focus { border-color: var(--gold); }
        .svc-input::placeholder { color: var(--text-dim); }
        .svc-select { width: 100%; background: var(--ink); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-sm); padding: 13px 15px; font-family: 'DM Sans', sans-serif; font-size: 0.88rem; color: var(--text-primary); margin-bottom: 12px; outline: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' fill='none'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%237A90A8' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 14px center; transition: border-color 0.2s; }
        .svc-select:focus { border-color: var(--gold); }
        .svc-label { font-size: 0.68rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 6px; display: block; }
        .svc-btn { width: 100%; padding: 15px; background: var(--gold); color: var(--ink); border: none; border-radius: var(--radius-sm); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.95rem; cursor: pointer; transition: transform 0.15s, box-shadow 0.15s; margin-top: 4px; }
        .svc-btn:active { transform: scale(0.97); box-shadow: 0 0 24px rgba(240,192,64,0.35); }
        .svc-btn.secondary { background: var(--surface-raised); color: var(--text-primary); border: 1px solid rgba(255,255,255,0.08); }
        .svc-btn.teal { background: rgba(45,212,191,0.12); color: var(--accent-teal); border: 1px solid rgba(45,212,191,0.25); }
        .svc-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .svc-card { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius); padding: 16px; margin-bottom: 12px; }
        .svc-card-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.88rem; color: var(--text-primary); margin-bottom: 4px; }
        .svc-card-sub { font-size: 0.72rem; color: var(--text-muted); }
        .svc-divider { height: 1px; background: rgba(255,255,255,0.05); margin: 16px 0; }
        .svc-tag { display: inline-block; font-size: 0.65rem; font-weight: 600; padding: 3px 9px; border-radius: 20px; margin-right: 4px; margin-bottom: 4px; }
        .svc-tag.gold { background: rgba(240,192,64,0.12); color: var(--gold); border: 1px solid rgba(240,192,64,0.2); }
        .svc-tag.teal { background: rgba(45,212,191,0.1); color: var(--accent-teal); border: 1px solid rgba(45,212,191,0.2); }
        .svc-tag.orange { background: rgba(249,115,22,0.1); color: var(--accent-orange); border: 1px solid rgba(249,115,22,0.2); }

        /* â”€â”€ MECHANIC CARD â”€â”€ */
        .mechanic-card { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius); padding: 16px; margin-bottom: 10px; display: flex; align-items: center; gap: 14px; cursor: pointer; transition: background 0.18s, border-color 0.18s; }
        .mechanic-card:hover { background: var(--surface-raised); border-color: rgba(240,192,64,0.2); }
        .mechanic-avatar { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1rem; color: var(--ink); flex-shrink: 0; }
        .mechanic-info { flex: 1; }
        .mechanic-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.88rem; color: var(--text-primary); }
        .mechanic-spec { font-size: 0.72rem; color: var(--text-muted); margin-top: 1px; }
        .mechanic-meta { display: flex; gap: 8px; margin-top: 4px; align-items: center; }
        .mechanic-rating { font-size: 0.7rem; color: var(--gold); font-weight: 600; }
        .mechanic-dist { font-size: 0.68rem; color: var(--text-dim); }
        .mechanic-price { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.9rem; color: var(--gold); text-align: right; }
        .mechanic-avail { font-size: 0.62rem; color: var(--success); text-align: right; margin-top: 2px; }

        /* â”€â”€ JOB CARD â”€â”€ */
        .job-card { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius); padding: 16px; margin-bottom: 10px; cursor: pointer; transition: background 0.18s, border-color 0.18s; }
        .job-card:hover { background: var(--surface-raised); border-color: rgba(240,192,64,0.2); }
        .job-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
        .job-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.9rem; color: var(--text-primary); }
        .job-company { font-size: 0.72rem; color: var(--text-muted); margin-top: 2px; }
        .job-salary { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.85rem; color: var(--gold); }
        .job-tags { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 8px; }

        /* â”€â”€ CARGO CARD â”€â”€ */
        .cargo-status-bar { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius); padding: 16px; margin-bottom: 12px; }
        .cargo-track-row { display: flex; align-items: center; gap: 0; margin-bottom: 16px; }
        .track-node { display: flex; flex-direction: column; align-items: center; flex-shrink: 0; }
        .track-dot { width: 12px; height: 12px; border-radius: 50%; border: 2px solid var(--text-dim); background: transparent; }
        .track-dot.done { background: var(--success); border-color: var(--success); }
        .track-dot.active { background: var(--gold); border-color: var(--gold); box-shadow: 0 0 8px rgba(240,192,64,0.5); }
        .track-label { font-size: 0.58rem; color: var(--text-dim); text-align: center; margin-top: 5px; max-width: 52px; }
        .track-dot.done ~ .track-label, .track-dot.active ~ .track-label { color: var(--text-muted); }
        .track-line { flex: 1; height: 2px; background: var(--surface-high); margin-bottom: 20px; }
        .track-line.done { background: var(--success); }

        /* â”€â”€ CONDUCTOR PORTAL â”€â”€ */
        .conductor-portal { display: none; position: fixed; inset: 0; background: #060B14; z-index: 500; overflow-y: auto; }
        .conductor-portal.open { display: block; }
        .conductor-inner { width: 100%; max-width: 430px; min-height: 100vh; margin: 0 auto; }
        .c-screen { display: none; }
        .c-screen.active { display: block; }
        .c-login { display: flex; flex-direction: column; padding: 40px 24px 30px; min-height: 100vh; justify-content: center; }
        .c-badge { width: 76px; height: 76px; background: linear-gradient(135deg, #1E3A5F, #0D2340); border: 2px solid rgba(240,192,64,0.35); border-radius: 22px; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; margin: 0 auto 18px; }
        .c-title { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.5rem; color: var(--text-primary); text-align: center; margin-bottom: 4px; }
        .c-subtitle { font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-bottom: 28px; }
        .c-field-label { font-size: 0.68rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 6px; }
        .c-input { width: 100%; background: var(--surface); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-sm); padding: 13px 15px; font-family: 'DM Sans', sans-serif; font-size: 0.95rem; color: var(--text-primary); margin-bottom: 16px; outline: none; transition: border-color 0.2s; }
        .c-input:focus { border-color: var(--gold); }
        .c-input::placeholder { color: var(--text-dim); }
        .c-select { width: 100%; background: var(--surface); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-sm); padding: 13px 15px; font-family: 'DM Sans', sans-serif; font-size: 0.88rem; color: var(--text-primary); margin-bottom: 16px; outline: none; transition: border-color 0.2s; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' fill='none'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%237A90A8' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 14px center; }
        .c-select:focus { border-color: var(--gold); }
        .c-pin-wrap { display: flex; gap: 12px; justify-content: center; margin-bottom: 18px; }
        .c-pin-dot { width: 52px; height: 58px; background: var(--surface); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-xs); display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.4rem; color: var(--text-primary); transition: all 0.2s; }
        .c-pin-dot.filled { border-color: var(--gold); background: rgba(240,192,64,0.08); color: var(--gold); }
        .c-numpad { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; margin-bottom: 20px; }
        .c-num-btn { background: var(--surface-raised); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius-sm); padding: 16px 8px; font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.2rem; color: var(--text-primary); cursor: pointer; text-align: center; transition: background 0.15s, transform 0.1s; user-select: none; }
        .c-num-btn:active { background: rgba(240,192,64,0.12); transform: scale(0.94); color: var(--gold); }
        .c-num-btn.del { font-size: 1rem; color: var(--text-muted); }
        .c-num-btn.empty { background: none; border: none; cursor: default; }
        .c-login-btn { width: 100%; padding: 16px; background: var(--gold); color: var(--ink); border: none; border-radius: var(--radius-sm); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; cursor: pointer; transition: transform 0.15s, opacity 0.2s; }
        .c-login-btn:disabled { opacity: 0.38; cursor: default; }
        .c-login-btn:not(:disabled):active { transform: scale(0.97); }
        .c-back-link { text-align: center; font-size: 0.8rem; color: var(--text-dim); margin-top: 14px; cursor: pointer; }
        .c-back-link:hover { color: var(--text-muted); }
        .c-demo-hint { margin-top: 20px; text-align: center; font-size: 0.7rem; color: var(--text-dim); background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-xs); padding: 10px 12px; line-height: 1.6; }
        .c-topbar { display: flex; align-items: center; gap: 6px; padding: 14px 14px 10px; background: var(--ink); position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(255,255,255,0.04); }
        .c-tab-pill { flex: 1; padding: 8px 4px; border: none; cursor: pointer; background: var(--surface); border-radius: 8px; font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.62rem; color: var(--text-dim); letter-spacing: 0.04em; transition: all 0.18s; }
        .c-tab-pill.active { background: var(--gold); color: var(--ink); }
        .c-logout-btn { background: rgba(249,115,22,0.1); border: 1px solid rgba(249,115,22,0.2); border-radius: var(--radius-xs); color: var(--accent-orange); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.68rem; padding: 8px 12px; cursor: pointer; }
        .c-tab { display: none; padding: 18px 18px 40px; animation: fadeUp 0.3s ease; }
        .c-tab.active { display: block; }
        .c-profile-hero { background: linear-gradient(135deg, #1E3A5F 0%, #0D2340 100%); border: 1px solid rgba(240,192,64,0.15); border-radius: var(--radius); padding: 24px 16px 20px; text-align: center; margin-bottom: 14px; }
        .c-profile-avatar { width: 70px; height: 70px; border-radius: 50%; background: linear-gradient(135deg, var(--gold), var(--gold-dark)); display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.5rem; color: var(--ink); margin: 0 auto 12px; border: 3px solid rgba(240,192,64,0.4); }
        .c-profile-name { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.15rem; color: var(--text-primary); margin-bottom: 3px; }
        .c-profile-id { font-size: 0.78rem; color: var(--gold); letter-spacing: 0.08em; margin-bottom: 8px; }
        .c-profile-status { display: inline-flex; align-items: center; gap: 6px; font-size: 0.72rem; color: var(--success); background: rgba(52,211,153,0.08); border: 1px solid rgba(52,211,153,0.2); padding: 4px 12px; border-radius: 20px; }
        .c-status-dot { width: 6px; height: 6px; background: var(--success); border-radius: 50%; animation: pulse 2s infinite; }
        .c-profile-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 14px; }
        .c-profile-card { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); padding: 14px 12px; text-align: center; }
        .c-pc-icon { font-size: 1.3rem; margin-bottom: 5px; }
        .c-pc-val { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.88rem; color: var(--gold); }
        .c-pc-key { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.07em; margin-top: 2px; }
        .c-info-block { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); margin-bottom: 14px; overflow: hidden; }
        .c-info-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.04); }
        .c-info-row:last-child { border-bottom: none; }
        .c-info-key { font-size: 0.72rem; color: var(--text-dim); }
        .c-info-val { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.8rem; color: var(--text-primary); }
        .c-shift-stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 16px; }
        .c-ss-box { background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); padding: 13px 10px; text-align: center; }
        .c-ss-val { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.2rem; color: var(--gold); }
        .c-ss-key { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; margin-top: 3px; }
        .c-action-btn { width: 100%; padding: 15px; border: none; border-radius: var(--radius-sm); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.92rem; cursor: pointer; transition: transform 0.15s; display: block; }
        .c-action-btn.gold { background: var(--gold); color: var(--ink); }
        .c-action-btn.teal { background: rgba(45,212,191,0.12); color: var(--accent-teal); border: 1px solid rgba(45,212,191,0.25); }
        .c-action-btn:active { transform: scale(0.97); }
        .c-section-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.95rem; color: var(--text-primary); margin-bottom: 16px; }
        .c-bc-form { margin-bottom: 20px; }
        .c-bc-card { background: #fff; border-radius: var(--radius); overflow: hidden; margin-bottom: 10px; box-shadow: 0 8px 40px rgba(0,0,0,0.5); }
        .c-bc-card-header { background: var(--ink); padding: 14px 16px; display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 3px solid var(--gold); }
        .c-bc-route { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1rem; color: var(--gold); }
        .c-bc-trip { font-size: 0.75rem; color: var(--text-muted); margin-top: 2px; }
        .c-bc-fare { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.1rem; color: var(--text-primary); }
        .c-bc-time { font-size: 0.72rem; color: var(--text-muted); text-align: right; }
        .c-bc-wrap { background: #fff; padding: 20px 16px 10px; display: flex; justify-content: center; }
        .c-bc-wrap svg { max-width: 100%; height: auto; }
        .c-bc-code-txt { text-align: center; font-family: 'Courier New', monospace; font-size: 0.85rem; font-weight: 700; color: #222; padding: 0 16px 8px; letter-spacing: 0.12em; }
        .c-bc-meta { display: flex; justify-content: center; gap: 6px; flex-wrap: wrap; font-size: 0.62rem; color: #666; padding: 0 16px 12px; text-align: center; }
        .c-bc-hint { background: #f8f8f8; border-top: 1px solid #eee; text-align: center; font-size: 0.7rem; color: #888; padding: 8px 12px; }
        .c-verify-box { background: var(--surface); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius); padding: 18px; margin-bottom: 14px; }
        .c-code-entry { display: flex; gap: 7px; margin-bottom: 14px; }
        .c-digit { flex: 1; height: 52px; background: var(--ink); border: 1.5px solid rgba(255,255,255,0.08); border-radius: var(--radius-xs); display: flex; align-items: center; justify-content: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.3rem; color: var(--text-primary); transition: border-color 0.2s; }
        .c-digit.active-digit { border-color: var(--gold); background: rgba(240,192,64,0.06); }
        .c-digit.filled-digit { border-color: rgba(240,192,64,0.3); color: var(--gold); }
        .c-verify-numpad { display: grid; grid-template-columns: repeat(3,1fr); gap: 8px; margin-bottom: 14px; }
        .cv-btn { background: var(--surface-raised); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius-xs); padding: 13px 6px; font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.1rem; color: var(--text-primary); cursor: pointer; text-align: center; transition: background 0.15s, transform 0.1s; user-select: none; }
        .cv-btn:active { background: rgba(240,192,64,0.12); transform: scale(0.94); color: var(--gold); }
        .cv-btn.del-v { font-size: 0.9rem; color: var(--text-muted); }
        .cv-btn.empty-v { background: none; border: none; cursor: default; }
        .c-verify-btn { width: 100%; padding: 14px; background: var(--gold); color: var(--ink); border: none; border-radius: var(--radius-sm); font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.95rem; cursor: pointer; transition: transform 0.15s, opacity 0.2s; }
        .c-verify-btn:disabled { opacity: 0.35; cursor: default; }
        .c-verify-btn:not(:disabled):active { transform: scale(0.97); }
        .c-result { border-radius: var(--radius-sm); padding: 16px; margin-bottom: 14px; animation: fadeUp 0.3s ease; }
        .c-result.valid { background: rgba(52,211,153,0.08); border: 1.5px solid rgba(52,211,153,0.3); }
        .c-result.invalid { background: rgba(249,115,22,0.08); border: 1.5px solid rgba(249,115,22,0.3); }
        .c-result-icon { font-size: 1.5rem; margin-bottom: 5px; }
        .c-result-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.92rem; margin-bottom: 10px; }
        .c-result.valid .c-result-title { color: var(--success); }
        .c-result.invalid .c-result-title { color: var(--accent-orange); }
        .c-result-detail { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .c-rd-key { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.07em; }
        .c-rd-val { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.8rem; color: var(--text-primary); }
        .c-log-count { background: rgba(240,192,64,0.12); color: var(--gold); font-size: 0.68rem; padding: 2px 8px; border-radius: 20px; }
        .c-log-empty { text-align: center; font-size: 0.78rem; color: var(--text-dim); padding: 20px 0; }
        .c-log-item { display: flex; align-items: center; gap: 10px; padding: 11px 0; border-bottom: 1px solid rgba(255,255,255,0.04); animation: fadeUp 0.25s ease; }
        .c-log-item:last-child { border-bottom: none; }
        .c-log-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .c-log-dot.ok { background: var(--success); }
        .c-log-dot.bad { background: var(--accent-orange); }
        .c-log-code { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.85rem; color: var(--text-primary); flex: 1; }
        .c-log-route { font-size: 0.68rem; color: var(--text-muted); }
        .c-log-status { font-size: 0.65rem; font-weight: 600; padding: 2px 8px; border-radius: 20px; }
        .c-log-status.ok { background: rgba(52,211,153,0.12); color: var(--success); }
        .c-log-status.bad { background: rgba(249,115,22,0.12); color: var(--accent-orange); }
        .conductor-entry-btn { display: flex; align-items: center; gap: 14px; padding: 16px; background: linear-gradient(135deg, rgba(240,192,64,0.08), rgba(240,192,64,0.03)); border: 1.5px solid rgba(240,192,64,0.22); border-radius: var(--radius-sm); cursor: pointer; transition: all 0.18s; margin-bottom: 10px; }
        .conductor-entry-btn:hover { background: rgba(240,192,64,0.12); border-color: rgba(240,192,64,0.4); }
        .conductor-entry-btn:active { transform: scale(0.98); }

        /* â”€â”€ SERVICE MODALS (full-screen sheets) â”€â”€ */
        .svc-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 300; justify-content: center; align-items: flex-end; backdrop-filter: blur(6px); }
        .svc-modal.open { display: flex; }
        .svc-sheet { background: var(--surface); border-radius: 24px 24px 0 0; width: 100%; max-width: 430px; max-height: 92vh; overflow-y: auto; animation: slideUp 0.3s ease; border-top: 1px solid rgba(255,255,255,0.08); }
        .svc-sheet-inner { padding: 8px 22px 40px; }
        .svc-sheet-handle { width: 40px; height: 4px; background: var(--surface-high); border-radius: 2px; margin: 14px auto 20px; }
        .svc-sheet-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1.1rem; color: var(--text-primary); margin-bottom: 6px; }
        .svc-sheet-sub { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 20px; }
        .svc-close { position: absolute; top: 18px; right: 20px; width: 30px; height: 30px; background: var(--surface-high); border: none; border-radius: 50%; color: var(--text-muted); font-size: 0.85rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* result states */
        .result-box { border-radius: var(--radius-sm); padding: 16px; margin-bottom: 14px; display: none; animation: fadeUp 0.3s ease; }
        .result-box.success { background: rgba(52,211,153,0.08); border: 1.5px solid rgba(52,211,153,0.3); }
        .result-box.warning { background: rgba(249,115,22,0.08); border: 1.5px solid rgba(249,115,22,0.3); }
        .result-icon-lg { font-size: 2rem; text-align: center; margin-bottom: 8px; }
        .result-title-lg { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.95rem; text-align: center; margin-bottom: 10px; }
        .result-box.success .result-title-lg { color: var(--success); }
        .result-box.warning .result-title-lg { color: var(--accent-orange); }
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .result-item { background: rgba(255,255,255,0.04); border-radius: var(--radius-xs); padding: 10px 12px; }
        .result-item-key { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.07em; margin-bottom: 2px; }
        .result-item-val { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.82rem; color: var(--text-primary); }
        .spinner-sm { width: 36px; height: 36px; border: 3px solid rgba(240,192,64,0.15); border-top-color: var(--gold); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 12px; }
        .loading-box { text-align: center; padding: 20px 0; display: none; }
        .loading-box.show { display: block; }
        /* â”€â”€ VENDOR CATEGORY PILLS â”€â”€ */
        .vendor-cat-pill { padding: 6px 12px; background: var(--surface-raised); border: 1px solid rgba(255,255,255,0.06); border-radius: 20px; font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.7rem; color: var(--text-dim); cursor: pointer; transition: all 0.18s; white-space: nowrap; }
        .vendor-cat-pill.active, .vendor-cat-pill:hover { background: rgba(240,192,64,0.12); color: var(--gold); border-color: rgba(240,192,64,0.3); }

        /* â”€â”€ VENDOR LIST CARD â”€â”€ */
        .vendor-row { display: flex; align-items: center; gap: 12px; padding: 13px 14px; background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); cursor: pointer; transition: background 0.18s, border-color 0.18s; margin-bottom: 8px; }
        .vendor-row:hover { background: var(--surface-raised); border-color: rgba(240,192,64,0.2); }
        .vendor-row:active { transform: scale(0.98); }
        .vendor-icon-box { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; flex-shrink: 0; }
        .vendor-info { flex: 1; }
        .vendor-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 0.85rem; color: var(--text-primary); }
        .vendor-meta { font-size: 0.68rem; color: var(--text-muted); margin-top: 2px; }
        .vendor-rating { font-size: 0.72rem; color: var(--gold); font-weight: 600; }

        /* â”€â”€ VAULT DOCUMENT ITEMS â”€â”€ */
        .vault-item { display: flex; align-items: center; gap: 12px; padding: 13px 14px; background: var(--surface); border: 1px solid rgba(255,255,255,0.05); border-radius: var(--radius-sm); margin-bottom: 8px; animation: fadeUp 0.25s ease; }
        .vault-item-icon { font-size: 1.4rem; flex-shrink: 0; }
        .vault-item-info { flex: 1; }
        .vault-item-name { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 0.85rem; color: var(--text-primary); }
        .vault-item-meta { font-size: 0.68rem; color: var(--text-muted); margin-top: 2px; }
        .vault-item-badge { font-size: 0.6rem; font-weight: 600; padding: 3px 8px; border-radius: 20px; background: rgba(52,211,153,0.12); color: var(--success); border: 1px solid rgba(52,211,153,0.2); }
        .vault-delete { background: none; border: none; font-size: 0.9rem; color: var(--text-dim); cursor: pointer; padding: 4px; transition: color 0.15s; }
        .vault-delete:hover { color: var(--danger); }

        /* â”€â”€ AMBASSADOR CHAT â”€â”€ */
        .chat-msg { margin-bottom: 8px; }
        .chat-msg.user { text-align: right; }
        .chat-bubble { display: inline-block; padding: 7px 12px; border-radius: 14px; font-size: 0.78rem; max-width: 80%; line-height: 1.4; }
        .chat-msg.user .chat-bubble { background: rgba(240,192,64,0.15); color: var(--gold); border-bottom-right-radius: 4px; }
        .chat-msg.amb .chat-bubble { background: var(--surface-raised); color: var(--text-primary); border-bottom-left-radius: 4px; }
        .chat-sender { font-size: 0.6rem; color: var(--text-dim); margin-bottom: 3px; }
        .chat-msg.user .chat-sender { text-align: right; }
    </style>
</head>
<body>

<div class="app-shell">

    <!-- HEADER -->
    <header>
        <div class="header-top">
            <div class="brand">
                <div class="brand-mark">PU</div>
                <div class="brand-name">PROJECT <span>UNIFIED</span></div>
            </div>
            <div class="notif-btn" onclick="openNotifications()">
                ðŸ””
                <div class="notif-dot" id="notif-dot"></div>
            </div>
        </div>

        <div class="wallet-card">
            <div class="wallet-label">Reflecting Balance</div>
            <div class="wallet-balance">
                <sup>K</sup><span id="balance-display">0.00</span>
            </div>
            <div class="wallet-footer">
                <div class="wallet-status">
                    <div class="wallet-status-dot"></div>
                    Active Wallet
                </div>
                <button class="topup-btn" onclick="openTopUp()">+ Top Up</button>
            </div>
        </div>
    </header>

    <!-- NAVIGATION -->
    <nav>
        <button class="tab-btn active" onclick="showPage('home', this)">HOME</button>
        <button class="tab-btn" onclick="showPage('auto', this)">TRANSPORT</button>
        <button class="tab-btn" onclick="showPage('jobs', this)">JOBS</button>
        <button class="tab-btn" onclick="showPage('logistics', this)">CARGO</button>
    </nav>

    <main>

        <!-- â•â• HOME PAGE â•â• -->
        <section id="home" class="page active">
            <div class="info-banner">
                <span class="info-banner-icon">ðŸ“¶</span>
                <span class="info-banner-text">Free Wi-Fi Active Â· City Market Zone</span>
            </div>

            <div class="stats-row">
                <div class="stat-box">
                    <div class="stat-value" style="color: var(--gold)">12</div>
                    <div class="stat-label">Vendors</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" style="color: var(--accent-teal)" id="home-jobs-count">7</div>
                    <div class="stat-label">Active Jobs</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" style="color: var(--success)">98%</div>
                    <div class="stat-label">Uptime</div>
                </div>
            </div>

            <div class="section-header">
                <span class="section-title">Quick Services</span>
            </div>

            <div class="quick-grid">
                <div class="quick-card" onclick="showPage('auto', document.querySelectorAll('.tab-btn')[1])">
                    <span class="quick-card-icon">ðŸšŒ</span>
                    <div class="quick-card-label">Bus Ticket</div>
                    <div class="quick-card-sub">Scan or book</div>
                    <span class="quick-card-arrow">â†’</span>
                </div>
                <div class="quick-card" onclick="showPage('jobs', document.querySelectorAll('.tab-btn')[2])">
                    <span class="quick-card-icon">ðŸ’¼</span>
                    <div class="quick-card-label">Find Jobs</div>
                    <div class="quick-card-sub">3 tries free</div>
                    <span class="quick-card-arrow">â†’</span>
                </div>
                <div class="quick-card" onclick="openMechanicModal()">
                    <span class="quick-card-icon">ðŸ”§</span>
                    <div class="quick-card-label">Mechanic</div>
                    <div class="quick-card-sub">Vetted pros</div>
                    <span class="quick-card-arrow">â†’</span>
                </div>
                <div class="quick-card" onclick="openTrustModal()">
                    <span class="quick-card-icon">ðŸ›¡ï¸</span>
                    <div class="quick-card-label">Support</div>
                    <div class="quick-card-sub">Trust & safety</div>
                    <span class="quick-card-arrow">â†’</span>
                </div>
            </div>

            <div class="section-header">
                <span class="section-title">Recent Activity</span>
            </div>

            <div id="activity-feed">
                <div class="action-row" style="cursor: default;">
                    <div class="action-icon-wrap teal">âœ…</div>
                    <div class="action-text">
                        <div class="action-label">Wallet Verified</div>
                        <div class="action-desc">Identity confirmed Â· Today</div>
                    </div>
                    <span class="action-badge badge-new">Done</span>
                </div>
                <div class="action-row" style="cursor: default;">
                    <div class="action-icon-wrap gold">ðŸŽ¯</div>
                    <div class="action-text">
                        <div class="action-label">Profile Setup Complete</div>
                        <div class="action-desc">Ambassador tier available</div>
                    </div>
                    <span class="action-badge badge-gold">New</span>
                </div>
            </div>
        </section>

        <!-- â•â• TRANSPORT PAGE â•â• -->
        <section id="auto" class="page">
            <div class="section-header">
                <span class="section-title">AutoRelief Transport</span>
                <span class="section-chip">4 Services</span>
            </div>

            <div class="action-row" onclick="openTicketScanner()">
                <div class="action-icon-wrap gold">ðŸŽ«</div>
                <div class="action-text">
                    <div class="action-label">Scan Bus Ticket</div>
                    <div class="action-desc">Scan QR Â· Pay Â· Get conductor code</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openFuelModal()">
                <div class="action-icon-wrap orange">â›½</div>
                <div class="action-text">
                    <div class="action-label">On-Demand Fuel</div>
                    <div class="action-desc">Delivery to your location via GPS</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openMechanicModal()">
                <div class="action-icon-wrap teal">ðŸ”§</div>
                <div class="action-text">
                    <div class="action-label">Verified Mechanics</div>
                    <div class="action-desc">Background-checked, rated pros</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openSwapModal()">
                <div class="action-icon-wrap gold">ðŸ”„</div>
                <div class="action-text">
                    <div class="action-label">Swap & Insurance</div>
                    <div class="action-desc">Battery swap + maintenance cover</div>
                </div>
                <span class="action-badge badge-gold">Phase 4</span>
            </div>

            <div class="conductor-entry-btn" onclick="openConductorPortal()">
                <div class="action-icon-wrap gold">ðŸšŒ</div>
                <div class="action-text">
                    <div class="action-label" style="color:var(--gold); font-family:'Syne',sans-serif; font-weight:700;">Conductor Portal</div>
                    <div class="action-desc">Login &amp; verify passenger codes</div>
                </div>
                <span class="action-badge badge-gold">Staff</span>
            </div>

            <a href="https://samuelmwaz.github.io/Project-Unified/home" target="_blank" class="action-row" style="text-decoration: none;">
                <div class="action-icon-wrap teal">ðŸŒ</div>
                <div class="action-text">
                    <div class="action-label">Transportation Website</div>
                    <div class="action-desc">Explore full transport services online</div>
                </div>
                <span class="action-badge badge-new">Visit</span>
            </a>
        </section>

        <!-- â•â• JOBS PAGE â•â• -->
        <section id="jobs" class="page">
            <div class="section-header">
                <span class="section-title">Job Connect</span>
                <span class="section-chip">Active</span>
            </div>

            <div class="tries-card">
                <div>
                    <div class="tries-counter" id="tries-display">3</div>
                    <div style="font-size:0.62rem; color: var(--text-dim); margin-top: 2px;">REMAINING</div>
                </div>
                <div class="action-text">
                    <div class="tries-label">Free Applications</div>
                    <div class="tries-sub">Upgrade for K200 Â· 5 additional tries</div>
                    <div class="tries-dots" id="tries-dots" style="margin-top: 8px;">
                        <div class="tries-dot"></div>
                        <div class="tries-dot"></div>
                        <div class="tries-dot"></div>
                    </div>
                </div>
            </div>

            <!-- Job listings -->
            <div class="section-header">
                <span class="section-title">Open Positions</span>
                <span class="section-chip">7 Jobs</span>
            </div>

            <div class="job-card" onclick="openJobModal({title:'Bus Driver',company:'Lusaka City Transport',salary:'K 4,500/mo',type:'Full-Time',location:'Lusaka CBD',exp:'2+ yrs',desc:'Drive urban routes safely. Valid PSV licence required. Benefits include health cover and pension.'})">
                <div class="job-header">
                    <div>
                        <div class="job-title">Bus Driver</div>
                        <div class="job-company">Lusaka City Transport</div>
                    </div>
                    <div class="job-salary">K 4,500</div>
                </div>
                <div class="job-tags">
                    <span class="svc-tag gold">Full-Time</span>
                    <span class="svc-tag teal">Transport</span>
                    <span class="svc-tag gold">PSV Required</span>
                </div>
            </div>

            <div class="job-card" onclick="openJobModal({title:'Warehouse Supervisor',company:'ZamFreight Ltd',salary:'K 6,200/mo',type:'Full-Time',location:'Industrial Area',exp:'3+ yrs',desc:'Oversee daily warehouse operations, manage staff of 12, coordinate shipments. Forklift cert a plus.'})">
                <div class="job-header">
                    <div>
                        <div class="job-title">Warehouse Supervisor</div>
                        <div class="job-company">ZamFreight Ltd</div>
                    </div>
                    <div class="job-salary">K 6,200</div>
                </div>
                <div class="job-tags">
                    <span class="svc-tag gold">Full-Time</span>
                    <span class="svc-tag orange">Logistics</span>
                </div>
            </div>

            <div class="job-card" onclick="openJobModal({title:'Mechanic (Auto)',company:'RoadFix Zambia',salary:'K 3,800/mo',type:'Full-Time',location:'Chilenje',exp:'2+ yrs',desc:'Service and repair vehicles. Light and heavy commercial vehicles. Own tools preferred.'})">
                <div class="job-header">
                    <div>
                        <div class="job-title">Mechanic (Auto)</div>
                        <div class="job-company">RoadFix Zambia</div>
                    </div>
                    <div class="job-salary">K 3,800</div>
                </div>
                <div class="job-tags">
                    <span class="svc-tag gold">Full-Time</span>
                    <span class="svc-tag teal">Technical</span>
                </div>
            </div>

            <div class="job-card" onclick="openJobModal({title:'Fuel Station Attendant',company:'ZamEnergy',salary:'K 2,400/mo',type:'Part-Time',location:'Multiple Locations',exp:'Entry Level',desc:'Serve customers, handle cash transactions, maintain station cleanliness. Training provided.'})">
                <div class="job-header">
                    <div>
                        <div class="job-title">Fuel Station Attendant</div>
                        <div class="job-company">ZamEnergy</div>
                    </div>
                    <div class="job-salary">K 2,400</div>
                </div>
                <div class="job-tags">
                    <span class="svc-tag orange">Part-Time</span>
                    <span class="svc-tag gold">Entry Level</span>
                </div>
            </div>

            <div class="action-row" onclick="openJobModal({title:'Delivery Rider',company:'QuickRun Zambia',salary:'K 3,200/mo',type:'Full-Time',location:'Lusaka Wide',exp:'1+ yr',desc:'Deliver packages across Lusaka. Own motorbike required. Fuel allowance included.'})">
                <div class="action-icon-wrap teal">ðŸ¤</div>
                <div class="action-text">
                    <div class="action-label">Guaranteed Interview</div>
                    <div class="action-desc">3 employer-backed slots available today</div>
                </div>
                <span class="action-badge badge-new">Hot</span>
            </div>

            <div class="action-row" onclick="openVendorDirectory()">
                <div class="action-icon-wrap orange">ðŸ“‹</div>
                <div class="action-text">
                    <div class="action-label">Vendor Directory</div>
                    <div class="action-desc">12 categories of trusted employers</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <a href="https://samuelmwaz.github.io/jobconnect-and-events/home" target="_blank" class="action-row" style="text-decoration: none;">
                <div class="action-icon-wrap teal">ðŸŒ</div>
                <div class="action-text">
                    <div class="action-label">Job Connect &amp; Events Website</div>
                    <div class="action-desc">Browse jobs, events &amp; opportunities online</div>
                </div>
                <span class="action-badge badge-new">Visit</span>
            </a>
        </section>

        <!-- â•â• LOGISTICS / CARGO PAGE â•â• -->
        <section id="logistics" class="page">
            <div class="section-header">
                <span class="section-title">Industrial Logistics</span>
                <span class="section-chip">Cargo</span>
            </div>

            <!-- Live tracking card -->
            <div class="cargo-status-bar">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:14px;">
                    <div>
                        <div style="font-family:'Syne',sans-serif; font-weight:700; font-size:0.9rem; color:var(--text-primary);">Shipment #ZM-2847</div>
                        <div style="font-size:0.7rem; color:var(--text-muted); margin-top:2px;">Lusaka Industrial â†’ Kitwe</div>
                    </div>
                    <span class="action-badge badge-new">In Transit</span>
                </div>
                <div class="cargo-track-row">
                    <div class="track-node">
                        <div class="track-dot done"></div>
                        <div class="track-label">Picked Up</div>
                    </div>
                    <div class="track-line done"></div>
                    <div class="track-node">
                        <div class="track-dot done"></div>
                        <div class="track-label">Sorted</div>
                    </div>
                    <div class="track-line done"></div>
                    <div class="track-node">
                        <div class="track-dot active"></div>
                        <div class="track-label">En Route</div>
                    </div>
                    <div class="track-line"></div>
                    <div class="track-node">
                        <div class="track-dot"></div>
                        <div class="track-label">Delivered</div>
                    </div>
                </div>
                <div style="font-size:0.72rem; color:var(--accent-orange); display:flex; align-items:center; gap:6px;">
                    <div style="width:6px;height:6px;background:var(--accent-orange);border-radius:50%;animation:pulse 1.5s infinite;"></div>
                    ETA: 14:30 today Â· 2 hrs remaining
                </div>
            </div>

            <div class="action-row" onclick="openPickupModal()">
                <div class="action-icon-wrap gold">ðŸ“</div>
                <div class="action-text">
                    <div class="action-label">Schedule Pickup</div>
                    <div class="action-desc">Enter GPS coords or postcode</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openRouteModal()">
                <div class="action-icon-wrap teal">ðŸš›</div>
                <div class="action-text">
                    <div class="action-label">Vendorâ€“Manufacturer Route</div>
                    <div class="action-desc">Optimised delivery pathfinding</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openPromoCredits()">
                <div class="action-icon-wrap orange">ðŸŽ</div>
                <div class="action-text">
                    <div class="action-label">Delivery Support Credits</div>
                    <div class="action-desc">Promotional credits for bulk shipments</div>
                </div>
                <span class="action-badge badge-promo">PROMO</span>
            </div>

            <div class="action-row" onclick="openTrackModal()">
                <div class="action-icon-wrap teal">ðŸ“¦</div>
                <div class="action-text">
                    <div class="action-label">Track Shipment</div>
                    <div class="action-desc">Enter tracking number or scan barcode</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>
        </section>

    </main>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!--           TICKET FLOW MODAL               -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="ticket-modal" onclick="handleTicketModalClick(event)">
    <div class="modal-sheet" style="max-height: 92vh; overflow-y: auto;">
        <div class="modal-handle"></div>
        <div class="ticket-step active" id="step-scan">
            <div class="modal-title">ðŸŽ« Scan Bus Ticket</div>
            <div class="qr-viewport">
                <div class="qr-corner tl"></div><div class="qr-corner tr"></div>
                <div class="qr-corner bl"></div><div class="qr-corner br"></div>
                <div class="qr-scan-line"></div>
                <div class="qr-inner-icon">ðŸ“·</div>
            </div>
            <p class="qr-hint">Point your camera at the QR code on your ticket or bus stop</p>
            <button class="sim-scan-btn" onclick="simulateScan()">ðŸ“² &nbsp;Tap to Scan QR Code</button>
            <span class="modal-cancel" onclick="closeTicketModal()">Cancel</span>
        </div>

        <div class="ticket-step" id="step-pay">
            <div class="modal-title">ðŸ’³ Confirm &amp; Pay</div>
            <div class="ticket-summary">
                <div class="ticket-route">
                    <div class="ticket-city">
                        <div class="ticket-city-name" id="tc-from">City Market</div>
                        <div class="ticket-city-label">From</div>
                    </div>
                    <div class="ticket-arrow">â†’</div>
                    <div class="ticket-city">
                        <div class="ticket-city-name" id="tc-to">Chilenje</div>
                        <div class="ticket-city-label">To</div>
                    </div>
                </div>
                <div class="ticket-meta">
                    <div class="ticket-meta-item"><div class="ticket-meta-val" id="tc-bus">Bus 14A</div><div class="ticket-meta-key">Route</div></div>
                    <div class="ticket-meta-item"><div class="ticket-meta-val" id="tc-seat">Seat 07</div><div class="ticket-meta-key">Seat</div></div>
                    <div class="ticket-meta-item"><div class="ticket-meta-val" id="tc-time">14:30</div><div class="ticket-meta-key">Departs</div></div>
                </div>
            </div>
            <div style="font-size:0.72rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.1em; margin-bottom:8px;">Mobile Money Provider</div>
            <div class="momo-providers">
                <div class="momo-option selected" id="momo-airtel" onclick="selectMomo('airtel')"><div class="momo-icon">ðŸŸ¥</div><div class="momo-name">Airtel Money</div></div>
                <div class="momo-option" id="momo-mtn" onclick="selectMomo('mtn')"><div class="momo-icon">ðŸŸ¨</div><div class="momo-name">MTN Money</div></div>
                <div class="momo-option" id="momo-zamtel" onclick="selectMomo('zamtel')"><div class="momo-icon">ðŸŸ©</div><div class="momo-name">Zamtel Kwacha</div></div>
                <div class="momo-option" id="momo-wallet" onclick="selectMomo('wallet')"><div class="momo-icon">ðŸ’›</div><div class="momo-name">PU Wallet</div></div>
            </div>
            <div id="phone-field">
                <div style="font-size:0.72rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.1em; margin-bottom:8px;">Mobile Number</div>
                <div class="momo-phone-row">
                    <div class="phone-prefix">+260</div>
                    <input class="phone-input" id="phone-input" type="tel" placeholder="97 123 4567" maxlength="10" />
                </div>
            </div>
            <div class="fare-total"><span class="fare-label">Total Fare</span><span class="fare-amount">K <span id="tc-fare">12.00</span></span></div>
            <button class="modal-confirm-btn" onclick="confirmPayment()">Pay Now â†’</button>
            <span class="modal-cancel" onclick="closeTicketModal()">Cancel</span>
        </div>

        <div class="ticket-step" id="step-processing">
            <div class="processing-wrap">
                <div class="processing-spinner"></div>
                <div class="processing-title">Processing Paymentâ€¦</div>
                <div class="processing-sub" id="processing-sub-text">Connecting to Airtel Money</div>
            </div>
        </div>

        <div class="ticket-step" id="step-code">
            <div style="text-align:center; margin-bottom:12px;">
                <div class="success-tick">âœ“</div>
                <div style="font-family:'Syne',sans-serif; font-weight:700; font-size:1.1rem; color:var(--success); margin-bottom:4px;">Payment Confirmed!</div>
                <div style="font-size:0.78rem; color:var(--text-muted);">Show this code to your conductor</div>
            </div>
            <div class="conductor-code-wrap">
                <div class="conductor-code-label">Conductor Code</div>
                <div class="conductor-code" id="conductor-code-display">â€”â€”</div>
                <div class="conductor-code-hint">Tell or show this 6-digit code to board</div>
            </div>
            <div class="code-expires"><div class="code-expires-dot"></div><span id="code-expires-txt">Expires in 30:00</span></div>
            <div class="boarding-info">
                <div class="boarding-box"><div class="boarding-box-val" id="bc-from">City Market</div><div class="boarding-box-key">From</div></div>
                <div class="boarding-box"><div class="boarding-box-val" id="bc-to">Chilenje</div><div class="boarding-box-key">To</div></div>
                <div class="boarding-box"><div class="boarding-box-val" id="bc-bus">Bus 14A</div><div class="boarding-box-key">Route</div></div>
                <div class="boarding-box"><div class="boarding-box-val" id="bc-fare">K 12.00</div><div class="boarding-box-key">Paid</div></div>
            </div>
            <button class="modal-confirm-btn" style="background:var(--surface-raised);color:var(--text-primary);" onclick="closeTicketModal()">Done âœ“</button>
        </div>
    </div>
</div>

<!-- â•â• TOP-UP MODAL â•â• -->
<div class="modal-overlay" id="topup-modal" onclick="handleModalClick(event)">
    <div class="modal-sheet">
        <div class="modal-handle"></div>
        <div class="modal-title">Top Up Wallet</div>
        <input type="number" class="modal-input" id="topup-input" placeholder="0.00" min="1" />
        <div class="quick-amounts">
            <div class="amount-chip" onclick="setAmount(50)">K 50</div>
            <div class="amount-chip" onclick="setAmount(100)">K 100</div>
            <div class="amount-chip" onclick="setAmount(200)">K 200</div>
            <div class="amount-chip" onclick="setAmount(500)">K 500</div>
        </div>
        <button class="modal-confirm-btn" onclick="confirmTopUp()">Confirm Top Up â†’</button>
        <span class="modal-cancel" onclick="closeTopUp()">Cancel</span>
    </div>
</div>

<!-- â•â• FUEL MODAL â•â• -->
<div class="svc-modal" id="fuel-modal" onclick="closeSvcModal('fuel-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">â›½ On-Demand Fuel Delivery</div>
            <div class="svc-sheet-sub">Fuel delivered to your location within 30â€“45 minutes</div>

            <label class="svc-label">Fuel Type</label>
            <select class="svc-select" id="fuel-type">
                <option>Petrol (92 Octane)</option>
                <option>Petrol (95 Octane)</option>
                <option>Diesel</option>
            </select>

            <label class="svc-label">Quantity (Litres)</label>
            <select class="svc-select" id="fuel-qty">
                <option value="10">10L â€” K 280</option>
                <option value="20">20L â€” K 560</option>
                <option value="30">30L â€” K 840</option>
                <option value="50">50L â€” K 1,400</option>
            </select>

            <label class="svc-label">Delivery Location</label>
            <input class="svc-input" id="fuel-location" placeholder="e.g. Corner of Cairo Rd &amp; Church Rd" />

            <label class="svc-label">Nearest Landmark</label>
            <input class="svc-input" id="fuel-landmark" placeholder="e.g. Near Shoprite, Chilenje" />

            <div class="svc-card" style="background:rgba(249,115,22,0.07); border-color:rgba(249,115,22,0.2); margin-bottom:14px;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-size:0.82rem; color:var(--text-muted);">Delivery Fee</span>
                    <span style="font-family:'Syne',sans-serif; font-weight:700; color:var(--accent-orange);">K 25.00</span>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-top:6px;">
                    <span style="font-size:0.82rem; color:var(--text-muted);">Est. Arrival</span>
                    <span style="font-size:0.82rem; color:var(--text-primary); font-weight:600;">30â€“45 min</span>
                </div>
            </div>

            <div class="loading-box" id="fuel-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Locating nearest fuel driverâ€¦</div>
            </div>
            <div class="result-box success" id="fuel-result">
                <div class="result-icon-lg">âœ…</div>
                <div class="result-title-lg">Fuel Order Confirmed!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Driver</div><div class="result-item-val" id="fuel-driver">Chanda M.</div></div>
                    <div class="result-item"><div class="result-item-key">ETA</div><div class="result-item-val">~38 min</div></div>
                    <div class="result-item"><div class="result-item-key">Quantity</div><div class="result-item-val" id="fuel-qty-result">20L</div></div>
                    <div class="result-item"><div class="result-item-key">Total</div><div class="result-item-val" id="fuel-total">K 585</div></div>
                </div>
            </div>

            <button class="svc-btn" id="fuel-submit-btn" onclick="submitFuelOrder()">ðŸ“ Request Fuel Delivery â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('fuel-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• MECHANIC MODAL â•â• -->
<div class="svc-modal" id="mechanic-modal" onclick="closeSvcModal('mechanic-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ”§ Verified Mechanics</div>
            <div class="svc-sheet-sub">Background-checked professionals near you</div>

            <label class="svc-label">Service Type</label>
            <select class="svc-select" id="mech-service">
                <option>Engine Diagnostics</option>
                <option>Brake Repair</option>
                <option>Tyre Change / Puncture</option>
                <option>Battery Jump Start</option>
                <option>Oil Change</option>
                <option>General Repair</option>
            </select>

            <div class="section-header" style="margin-bottom:12px;">
                <span class="section-title" style="font-size:0.88rem;">Available Mechanics</span>
                <span class="section-chip">4 Nearby</span>
            </div>

            <div class="mechanic-card" onclick="bookMechanic('Bwalya T.','Engine Specialist','4.9â˜…','1.2km','K 150/hr')">
                <div class="mechanic-avatar" style="background: linear-gradient(135deg,#F0C040,#C49B1A);">BT</div>
                <div class="mechanic-info">
                    <div class="mechanic-name">Bwalya Tembo</div>
                    <div class="mechanic-spec">Engine & Transmission Specialist</div>
                    <div class="mechanic-meta">
                        <span class="mechanic-rating">â­ 4.9</span>
                        <span class="mechanic-dist">Â· 1.2km away</span>
                    </div>
                </div>
                <div>
                    <div class="mechanic-price">K 150/hr</div>
                    <div class="mechanic-avail">â— Available</div>
                </div>
            </div>

            <div class="mechanic-card" onclick="bookMechanic('Moses K.','Brakes & Suspension','4.7â˜…','0.8km','K 120/hr')">
                <div class="mechanic-avatar" style="background: linear-gradient(135deg,#2DD4BF,#0D9488);">MK</div>
                <div class="mechanic-info">
                    <div class="mechanic-name">Moses Kabwe</div>
                    <div class="mechanic-spec">Brakes, Suspension & Tyres</div>
                    <div class="mechanic-meta">
                        <span class="mechanic-rating">â­ 4.7</span>
                        <span class="mechanic-dist">Â· 0.8km away</span>
                    </div>
                </div>
                <div>
                    <div class="mechanic-price">K 120/hr</div>
                    <div class="mechanic-avail">â— Available</div>
                </div>
            </div>

            <div class="mechanic-card" onclick="bookMechanic('Grace N.','Electrical & Auto-elec','4.8â˜…','2.1km','K 130/hr')">
                <div class="mechanic-avatar" style="background: linear-gradient(135deg,#F97316,#C2410C);">GN</div>
                <div class="mechanic-info">
                    <div class="mechanic-name">Grace Ngoma</div>
                    <div class="mechanic-spec">Auto-Electrician</div>
                    <div class="mechanic-meta">
                        <span class="mechanic-rating">â­ 4.8</span>
                        <span class="mechanic-dist">Â· 2.1km away</span>
                    </div>
                </div>
                <div>
                    <div class="mechanic-price">K 130/hr</div>
                    <div class="mechanic-avail" style="color:var(--accent-orange);">â— Busy Â· 20min</div>
                </div>
            </div>

            <div class="loading-box" id="mech-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Contacting mechanicâ€¦</div>
            </div>
            <div class="result-box success" id="mech-result">
                <div class="result-icon-lg">ðŸ”§</div>
                <div class="result-title-lg">Mechanic Booked!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Mechanic</div><div class="result-item-val" id="mech-name-result">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Speciality</div><div class="result-item-val" id="mech-spec-result">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">ETA</div><div class="result-item-val">~15 min</div></div>
                    <div class="result-item"><div class="result-item-key">Rate</div><div class="result-item-val" id="mech-rate-result">â€”</div></div>
                </div>
            </div>

            <button class="svc-btn secondary" style="margin-top:14px;" onclick="closeSvcModal('mechanic-modal',null,true)">Close</button>
        </div>
    </div>
</div>

<!-- â•â• SWAP & INSURANCE MODAL â•â• -->
<div class="svc-modal" id="swap-modal" onclick="closeSvcModal('swap-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ”„ Swap &amp; Insurance</div>
            <div class="svc-sheet-sub">Battery swap stations + vehicle maintenance cover</div>

            <div class="svc-card" style="background:linear-gradient(135deg,rgba(240,192,64,0.08),rgba(240,192,64,0.02)); border-color:rgba(240,192,64,0.2); margin-bottom:14px;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                    <span style="font-size:1.4rem;">ðŸ”‹</span>
                    <div>
                        <div style="font-family:'Syne',sans-serif; font-weight:700; font-size:0.9rem; color:var(--gold);">Battery Swap Network</div>
                        <div style="font-size:0.7rem; color:var(--text-muted);">Phase 4 Â· Launching Q3 2025</div>
                    </div>
                </div>
                <div style="font-size:0.78rem; color:var(--text-muted); line-height:1.5;">Swap depleted EV batteries in under 90 seconds at 12 network stations across Lusaka.</div>
                <div style="margin-top:10px; display:flex; flex-wrap:wrap; gap:4px;">
                    <span class="svc-tag gold">12 Stations</span>
                    <span class="svc-tag teal">90-Second Swap</span>
                    <span class="svc-tag orange">24/7 Access</span>
                </div>
            </div>

            <div class="section-header" style="margin-bottom:12px;"><span class="section-title" style="font-size:0.88rem;">Insurance Plans</span></div>

            <div class="svc-card" onclick="selectInsurancePlan(this,'basic')" style="cursor:pointer; margin-bottom:8px;" id="plan-basic">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <div style="font-family:'Syne',sans-serif; font-weight:700; font-size:0.88rem; color:var(--text-primary);">Basic Cover</div>
                        <div style="font-size:0.7rem; color:var(--text-muted); margin-top:2px;">Roadside assist + tyre change</div>
                    </div>
                    <div style="text-align:right;">
                        <div style="font-family:'Syne',sans-serif; font-weight:700; color:var(--gold);">K 89/mo</div>
                        <div id="plan-basic-check" style="display:none; font-size:0.7rem; color:var(--success);">âœ“ Selected</div>
                    </div>
                </div>
            </div>

            <div class="svc-card" onclick="selectInsurancePlan(this,'pro')" style="cursor:pointer; margin-bottom:8px; border-color:rgba(240,192,64,0.3);" id="plan-pro">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <div style="font-family:'Syne',sans-serif; font-weight:700; font-size:0.88rem; color:var(--gold);">â­ Pro Cover</div>
                        <div style="font-size:0.7rem; color:var(--text-muted); margin-top:2px;">Full mechanical + accident</div>
                    </div>
                    <div style="text-align:right;">
                        <div style="font-family:'Syne',sans-serif; font-weight:700; color:var(--gold);">K 199/mo</div>
                        <div id="plan-pro-check" style="display:none; font-size:0.7rem; color:var(--success);">âœ“ Selected</div>
                    </div>
                </div>
            </div>

            <div class="result-box success" id="swap-result" style="margin-top:12px;">
                <div class="result-icon-lg">ðŸ›¡ï¸</div>
                <div class="result-title-lg">Cover Activated!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Plan</div><div class="result-item-val" id="swap-plan-name">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Starts</div><div class="result-item-val">Today</div></div>
                    <div class="result-item"><div class="result-item-key">Billing</div><div class="result-item-val">Monthly</div></div>
                    <div class="result-item"><div class="result-item-key">Status</div><div class="result-item-val" style="color:var(--success);">Active</div></div>
                </div>
            </div>

            <button class="svc-btn" id="swap-btn" onclick="activateInsurance()" style="margin-top:12px;">Activate Insurance Plan â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('swap-modal',null,true)">Close</button>
        </div>
    </div>
</div>

<!-- â•â• JOB APPLICATION MODAL â•â• -->
<div class="svc-modal" id="job-modal" onclick="closeSvcModal('job-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title" id="job-modal-title">Job Application</div>
            <div class="svc-sheet-sub" id="job-modal-company">Company</div>

            <div class="svc-card" id="job-modal-desc-card" style="margin-bottom:14px;">
                <div style="font-size:0.8rem; color:var(--text-muted); line-height:1.55;" id="job-modal-desc">Description here.</div>
                <div style="margin-top:10px; display:flex; flex-wrap:wrap; gap:4px;" id="job-modal-tags"></div>
            </div>

            <div class="svc-card" style="margin-bottom:14px; background:rgba(240,192,64,0.05); border-color:rgba(240,192,64,0.15);">
                <div style="display:flex; justify-content:space-between;">
                    <span style="font-size:0.8rem; color:var(--text-muted);">Salary</span>
                    <span style="font-family:'Syne',sans-serif; font-weight:700; color:var(--gold);" id="job-modal-salary">â€”</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin-top:6px;">
                    <span style="font-size:0.8rem; color:var(--text-muted);">Location</span>
                    <span style="font-size:0.8rem; color:var(--text-primary); font-weight:600;" id="job-modal-location">â€”</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin-top:6px;">
                    <span style="font-size:0.8rem; color:var(--text-muted);">Experience</span>
                    <span style="font-size:0.8rem; color:var(--text-primary); font-weight:600;" id="job-modal-exp">â€”</span>
                </div>
            </div>

            <label class="svc-label">Your Full Name</label>
            <input class="svc-input" id="job-name" placeholder="e.g. Mwale Banda" />

            <label class="svc-label">Phone Number</label>
            <input class="svc-input" id="job-phone" type="tel" placeholder="+260 97 xxx xxxx" />

            <label class="svc-label">Why are you a good fit? (brief)</label>
            <textarea class="svc-input" id="job-why" placeholder="e.g. 3 years driving PSV buses in Lusakaâ€¦" style="height:80px; resize:none;"></textarea>

            <div class="loading-box" id="job-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Submitting application &amp; generating documentâ€¦</div>
            </div>
            <div class="result-box success" id="job-result">
                <div class="result-icon-lg">ðŸŽ‰</div>
                <div class="result-title-lg">Application Submitted!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Reference</div><div class="result-item-val" id="job-ref">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Tries Left</div><div class="result-item-val" id="job-tries-left">â€”</div></div>
                    <div class="result-item" style="grid-column:span 2;"><div class="result-item-key">Next Step</div><div class="result-item-val">Employer will contact you within 3 business days</div></div>
                </div>
            </div>

            <button class="svc-btn" id="job-apply-btn" onclick="submitJobApplication()">ðŸ“ Apply Now (uses 1 try) â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('job-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• VENDOR DIRECTORY MODAL â•â• -->
<div class="svc-modal" id="vendor-modal" onclick="closeSvcModal('vendor-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ“‹ Vendor Directory</div>
            <div class="svc-sheet-sub">Trusted employers &amp; service providers in Lusaka</div>

            <!-- Category filter pills -->
            <div style="display:flex; gap:6px; flex-wrap:wrap; margin-bottom:16px;" id="vendor-cats">
                <div class="vendor-cat-pill active" onclick="filterVendors('all')">All</div>
                <div class="vendor-cat-pill" onclick="filterVendors('transport')">ðŸšŒ Transport</div>
                <div class="vendor-cat-pill" onclick="filterVendors('logistics')">ðŸ“¦ Logistics</div>
                <div class="vendor-cat-pill" onclick="filterVendors('mechanical')">ðŸ”§ Mechanical</div>
                <div class="vendor-cat-pill" onclick="filterVendors('fuel')">â›½ Fuel</div>
                <div class="vendor-cat-pill" onclick="filterVendors('retail')">ðŸ›’ Retail</div>
                <div class="vendor-cat-pill" onclick="filterVendors('finance')">ðŸ’° Finance</div>
            </div>

            <div id="vendor-list"></div>

            <button class="svc-btn secondary" style="margin-top:6px;" onclick="closeSvcModal('vendor-modal',null,true)">Close</button>
        </div>
    </div>
</div>

<!-- â•â• VENDOR DETAIL MODAL â•â• -->
<div class="svc-modal" id="vendor-detail-modal" onclick="closeSvcModal('vendor-detail-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div style="display:flex; align-items:center; gap:14px; margin-bottom:18px;">
                <div id="vd-icon" style="width:52px;height:52px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:1.6rem;flex-shrink:0;"></div>
                <div>
                    <div class="svc-sheet-title" id="vd-name" style="margin-bottom:2px;"></div>
                    <div id="vd-category" style="font-size:0.7rem;color:var(--text-muted);"></div>
                </div>
            </div>

            <div class="svc-card" style="margin-bottom:12px;">
                <div style="font-size:0.82rem; color:var(--text-muted); line-height:1.55;" id="vd-desc"></div>
            </div>

            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:14px;">
                <div class="result-item"><div class="result-item-key">Location</div><div class="result-item-val" id="vd-location"></div></div>
                <div class="result-item"><div class="result-item-key">Rating</div><div class="result-item-val" id="vd-rating"></div></div>
                <div class="result-item"><div class="result-item-key">Contact</div><div class="result-item-val" id="vd-contact"></div></div>
                <div class="result-item"><div class="result-item-key">Hours</div><div class="result-item-val" id="vd-hours"></div></div>
            </div>

            <div id="vd-jobs-section" style="display:none;">
                <div class="svc-sheet-title" style="font-size:0.88rem; margin-bottom:10px;">Open Positions</div>
                <div id="vd-jobs-list"></div>
            </div>

            <button class="svc-btn" onclick="contactVendor()">ðŸ“ž Contact Vendor</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('vendor-detail-modal',null,true); document.getElementById('vendor-modal').classList.add('open')">â† Back to Directory</button>
        </div>
    </div>
</div>

<!-- â•â• PICKUP SCHEDULER MODAL â•â• -->
<div class="svc-modal" id="pickup-modal" onclick="closeSvcModal('pickup-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ“ Schedule Cargo Pickup</div>
            <div class="svc-sheet-sub">Enter your location and cargo details</div>

            <label class="svc-label">Pickup Location / GPS</label>
            <input class="svc-input" id="pickup-location" placeholder="e.g. -15.4167, 28.2833 or Cairo Rd" />

            <label class="svc-label">Destination</label>
            <input class="svc-input" id="pickup-dest" placeholder="e.g. Kitwe Industrial Area" />

            <div class="svc-row" style="margin-bottom:0;">
                <div>
                    <label class="svc-label">Cargo Type</label>
                    <select class="svc-select" id="pickup-cargo">
                        <option>General Goods</option>
                        <option>Perishables</option>
                        <option>Electronics</option>
                        <option>Industrial</option>
                        <option>Hazardous</option>
                    </select>
                </div>
                <div>
                    <label class="svc-label">Weight (kg)</label>
                    <input class="svc-input" id="pickup-weight" type="number" placeholder="e.g. 250" />
                </div>
            </div>

            <label class="svc-label">Preferred Date &amp; Time</label>
            <input class="svc-input" id="pickup-time" type="datetime-local" />

            <div class="loading-box" id="pickup-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Finding nearest available truckâ€¦</div>
            </div>
            <div class="result-box success" id="pickup-result">
                <div class="result-icon-lg">ðŸš›</div>
                <div class="result-title-lg">Pickup Scheduled!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Driver</div><div class="result-item-val">Mwape C.</div></div>
                    <div class="result-item"><div class="result-item-key">Truck</div><div class="result-item-val">ZM 8847 TK</div></div>
                    <div class="result-item"><div class="result-item-key">Reference</div><div class="result-item-val" id="pickup-ref">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Status</div><div class="result-item-val" style="color:var(--success);">Confirmed</div></div>
                </div>
            </div>

            <button class="svc-btn" id="pickup-btn" onclick="schedulePickup()">ðŸ“… Schedule Pickup â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('pickup-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• ROUTE PLANNER MODAL â•â• -->
<div class="svc-modal" id="route-modal" onclick="closeSvcModal('route-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸš› Route Planner</div>
            <div class="svc-sheet-sub">Optimised vendor-to-manufacturer delivery routing</div>

            <label class="svc-label">Origin (Vendor)</label>
            <select class="svc-select" id="route-from">
                <option>Lusaka Industrial Area</option>
                <option>Chilenje Market</option>
                <option>Northmead Depot</option>
                <option>City Market Lusaka</option>
            </select>

            <label class="svc-label">Destination (Manufacturer)</label>
            <select class="svc-select" id="route-to">
                <option>Kitwe Copper Belt</option>
                <option>Ndola Industrial</option>
                <option>Livingstone South</option>
                <option>Kabwe Central</option>
            </select>

            <label class="svc-label">Priority</label>
            <select class="svc-select" id="route-priority">
                <option>Fastest Route</option>
                <option>Most Economical</option>
                <option>Avoid Tolls</option>
                <option>Refrigerated Route</option>
            </select>

            <div class="loading-box" id="route-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Calculating optimal routeâ€¦</div>
            </div>
            <div class="result-box success" id="route-result">
                <div class="result-icon-lg">ðŸ—ºï¸</div>
                <div class="result-title-lg">Route Calculated!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Distance</div><div class="result-item-val" id="route-dist">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">ETA</div><div class="result-item-val" id="route-eta">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Toll Cost</div><div class="result-item-val" id="route-toll">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Fuel Est.</div><div class="result-item-val" id="route-fuel">â€”</div></div>
                </div>
            </div>

            <button class="svc-btn" id="route-btn" onclick="calcRoute()">ðŸ—ºï¸ Calculate Route â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('route-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• TRACK SHIPMENT MODAL â•â• -->
<div class="svc-modal" id="track-modal" onclick="closeSvcModal('track-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ“¦ Track Shipment</div>
            <div class="svc-sheet-sub">Enter your tracking number or scan barcode</div>

            <label class="svc-label">Tracking Number</label>
            <input class="svc-input" id="track-number" placeholder="e.g. ZM-2847 or ZM-1234" />

            <div class="loading-box" id="track-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Looking up shipmentâ€¦</div>
            </div>
            <div class="result-box success" id="track-result">
                <div class="result-icon-lg">ðŸ“¦</div>
                <div class="result-title-lg" id="track-status-title">Shipment Found</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Status</div><div class="result-item-val" id="track-status">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Location</div><div class="result-item-val" id="track-location">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">ETA</div><div class="result-item-val" id="track-eta">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Driver</div><div class="result-item-val" id="track-driver">â€”</div></div>
                </div>
            </div>
            <div class="result-box warning" id="track-notfound" style="text-align:center;">
                <div class="result-icon-lg">âŒ</div>
                <div class="result-title-lg">Shipment Not Found</div>
                <div style="font-size:0.78rem; color:var(--text-muted);">Check the tracking number and try again.</div>
            </div>

            <button class="svc-btn" id="track-btn" onclick="trackShipment()">ðŸ” Track Shipment â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('track-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• TRUST & SECURITY MODAL â•â• -->
<div class="svc-modal" id="trust-modal" onclick="closeSvcModal('trust-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ›¡ï¸ Trust &amp; Security</div>
            <div class="svc-sheet-sub">Every transaction is protected and documented</div>

            <div class="action-row" onclick="openDocVault()">
                <div class="action-icon-wrap teal">ðŸ“„</div>
                <div class="action-text">
                    <div class="action-label">Digital Document Vault</div>
                    <div class="action-desc" id="vault-desc">3 documents stored securely</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openMediationModal()">
                <div class="action-icon-wrap gold">âš–ï¸</div>
                <div class="action-text">
                    <div class="action-label">Mediation &amp; Disputes</div>
                    <div class="action-desc">Impartial arbitration service</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="action-row" onclick="openAmbassadorModal()">
                <div class="action-icon-wrap orange">ðŸ‘¤</div>
                <div class="action-text">
                    <div class="action-label">Yellow Vest Ambassador</div>
                    <div class="action-desc">Physical agent support network</div>
                </div>
                <span class="action-chevron">â€º</span>
            </div>

            <div class="svc-card" style="background:rgba(52,211,153,0.05); border-color:rgba(52,211,153,0.15); margin-top:6px;">
                <div style="font-size:0.78rem; color:var(--text-muted); line-height:1.55;">Every transaction on Project Unified produces <strong style="color:var(--text-primary);">3 official copies</strong> for full legal transparency and dispute resolution.</div>
            </div>

            <button class="svc-btn secondary" style="margin-top:14px;" onclick="closeSvcModal('trust-modal',null,true)">Close</button>
        </div>
    </div>
</div>

<!-- â•â• MEDIATION MODAL â•â• -->
<div class="svc-modal" id="mediation-modal" onclick="closeSvcModal('mediation-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">âš–ï¸ Raise a Dispute</div>
            <div class="svc-sheet-sub">Our team mediates within 48 hours</div>

            <label class="svc-label">Dispute Category</label>
            <select class="svc-select" id="dispute-type">
                <option>Payment Not Received</option>
                <option>Service Not Delivered</option>
                <option>Wrong Goods Delivered</option>
                <option>Driver Misconduct</option>
                <option>Other</option>
            </select>

            <label class="svc-label">Reference Number (optional)</label>
            <input class="svc-input" id="dispute-ref" placeholder="e.g. ZM-2847 or ticket code" />

            <label class="svc-label">Describe the issue</label>
            <textarea class="svc-input" id="dispute-desc" placeholder="Explain what happenedâ€¦" style="height:90px; resize:none;"></textarea>

            <div class="loading-box" id="dispute-loading">
                <div class="spinner-sm"></div>
                <div style="font-size:0.82rem; color:var(--text-muted);">Submitting disputeâ€¦</div>
            </div>
            <div class="result-box success" id="dispute-result">
                <div class="result-icon-lg">âš–ï¸</div>
                <div class="result-title-lg">Dispute Filed!</div>
                <div class="result-grid">
                    <div class="result-item"><div class="result-item-key">Case ID</div><div class="result-item-val" id="dispute-case">â€”</div></div>
                    <div class="result-item"><div class="result-item-key">Response By</div><div class="result-item-val">48 hours</div></div>
                </div>
            </div>

            <button class="svc-btn" id="dispute-btn" onclick="fileDispute()">âš–ï¸ Submit Dispute â†’</button>
            <button class="svc-btn secondary" style="margin-top:8px;" onclick="closeSvcModal('mediation-modal',null,true)">Cancel</button>
        </div>
    </div>
</div>

<!-- â•â• NOTIFICATIONS MODAL â•â• -->
<div class="svc-modal" id="notif-modal" onclick="closeSvcModal('notif-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ”” Notifications</div>
            <div class="svc-sheet-sub">Your recent updates</div>
            <div id="notif-list">
                <div class="action-row" style="cursor:default;">
                    <div class="action-icon-wrap gold">ðŸ’³</div>
                    <div class="action-text">
                        <div class="action-label">Wallet Verified</div>
                        <div class="action-desc">Your identity has been confirmed Â· Just now</div>
                    </div>
                </div>
                <div class="action-row" style="cursor:default;">
                    <div class="action-icon-wrap teal">ðŸšŒ</div>
                    <div class="action-text">
                        <div class="action-label">New Bus Route Available</div>
                        <div class="action-desc">Bus 18G â€” City Centre â†’ Lilayi added</div>
                    </div>
                </div>
                <div class="action-row" style="cursor:default;">
                    <div class="action-icon-wrap orange">ðŸŽ</div>
                    <div class="action-text">
                        <div class="action-label">Promo Credits Available</div>
                        <div class="action-desc">K 50 delivery credit expires in 3 days</div>
                    </div>
                    <span class="action-badge badge-promo">PROMO</span>
                </div>
            </div>
            <button class="svc-btn secondary" style="margin-top:14px;" onclick="closeSvcModal('notif-modal',null,true)">Close</button>
        </div>
    </div>
</div>

<!-- â•â• DOCUMENT VAULT MODAL â•â• -->
<div class="svc-modal" id="vault-modal" onclick="closeSvcModal('vault-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸ“„ Digital Document Vault</div>
            <div class="svc-sheet-sub">Encrypted secure storage for all your official documents</div>

            <div id="vault-list"></div>

            <div style="margin: 14px 0;">
                <label class="svc-label">Upload New Document</label>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:10px;">
                    <select class="svc-select" id="vault-doc-type" style="margin-bottom:0;">
                        <option>National ID</option>
                        <option>PSV Licence</option>
                        <option>Employment Contract</option>
                        <option>Pay Slip</option>
                        <option>Insurance Certificate</option>
                        <option>Vehicle Registration</option>
                        <option>Other</option>
                    </select>
                    <input class="svc-input" id="vault-doc-name" placeholder="Document name" style="margin-bottom:0;" />
                </div>
                <button class="svc-btn" onclick="uploadVaultDoc()" style="background:rgba(45,212,191,0.12); color:var(--accent-teal); border:1px solid rgba(45,212,191,0.25);">ðŸ“Ž Add Document</button>
            </div>

            <div class="svc-card" style="background:rgba(52,211,153,0.05); border-color:rgba(52,211,153,0.15);">
                <div style="font-size:0.75rem; color:var(--text-muted); line-height:1.5;">ðŸ”’ 256-bit encrypted Â· 3 certified copies per document Â· Admissible in legal proceedings</div>
            </div>

            <button class="svc-btn secondary" style="margin-top:12px;" onclick="closeSvcModal('vault-modal',null,true); document.getElementById('trust-modal').classList.add('open');">â† Back</button>
        </div>
    </div>
</div>

<!-- â•â• YELLOW VEST AMBASSADOR MODAL â•â• -->
<div class="svc-modal" id="ambassador-modal" onclick="closeSvcModal('ambassador-modal',event)">
    <div class="svc-sheet">
        <div class="svc-sheet-handle"></div>
        <div class="svc-sheet-inner">
            <div class="svc-sheet-title">ðŸŸ¡ Yellow Vest Ambassador</div>
            <div class="svc-sheet-sub">On-the-ground support agents across Lusaka</div>

            <!-- Nearest ambassador card -->
            <div class="svc-card" style="background:linear-gradient(135deg,rgba(249,115,22,0.08),rgba(249,115,22,0.02)); border-color:rgba(249,115,22,0.25); margin-bottom:14px;">
                <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
                    <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,#F97316,#C2410C);display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:800;font-size:1rem;color:#fff;flex-shrink:0;">SA</div>
                    <div>
                        <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:0.9rem;color:var(--text-primary);">Stella Achieng</div>
                        <div style="font-size:0.72rem;color:var(--text-muted);">City Market Zone Â· 0.4km away</div>
                        <div style="display:flex;align-items:center;gap:5px;margin-top:3px;"><div style="width:6px;height:6px;background:var(--success);border-radius:50%;animation:pulse 2s infinite;"></div><span style="font-size:0.68rem;color:var(--success);">On duty Â· Available now</span></div>
                    </div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                    <button class="svc-btn" onclick="callAmbassador()" style="padding:10px;font-size:0.8rem;">ðŸ“ž Call Stella</button>
                    <button class="svc-btn" onclick="openAmbassadorChat()" style="padding:10px;font-size:0.8rem;background:rgba(45,212,191,0.12);color:var(--accent-teal);border:1px solid rgba(45,212,191,0.25);">ðŸ’¬ Message</button>
                </div>
            </div>

            <div class="section-header" style="margin-bottom:12px;">
                <span class="section-title" style="font-size:0.88rem;">Other Ambassadors Nearby</span>
            </div>

            <div class="action-row" style="margin-bottom:8px;" onclick="selectAmbassador('TM','Temweka Mulenga','Northmead Zone','1.1km')">
                <div style="width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,#F0C040,#C49B1A);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:0.85rem;color:var(--ink);">TM</div>
                <div class="action-text">
                    <div class="action-label">Temweka Mulenga</div>
                    <div class="action-desc">Northmead Zone Â· 1.1km</div>
                </div>
                <span class="action-badge badge-new">Free</span>
            </div>

            <div class="action-row" style="margin-bottom:8px;" onclick="selectAmbassador('BK','Bwalya Kunda','Chelstone Zone','2.3km')">
                <div style="width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,#2DD4BF,#0D9488);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:0.85rem;color:var(--ink);">BK</div>
                <div class="action-text">
                    <div class="action-label">Bwalya Kunda</div>
                    <div class="action-desc">Chelstone Zone Â· 2.3km</div>
                </div>
                <span class="action-badge badge-gold">Busy</span>
            </div>

            <!-- Chat/message section -->
            <div id="amb-chat-section" style="display:none; margin-top:14px;">
                <div class="svc-sheet-title" style="font-size:0.88rem; margin-bottom:10px;">Send a Message</div>
                <div id="amb-chat-log" style="background:var(--ink);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius-sm);padding:12px;min-height:80px;max-height:160px;overflow-y:auto;margin-bottom:10px;font-size:0.78rem;line-height:1.6;color:var(--text-muted);">
                    <em>Chat started with Stella Achiengâ€¦</em>
                </div>
                <div style="display:flex;gap:8px;">
                    <input class="svc-input" id="amb-msg-input" placeholder="Type your messageâ€¦" style="margin-bottom:0;flex:1;" onkeydown="if(event.key==='Enter')sendAmbMsg()" />
                    <button class="svc-btn" onclick="sendAmbMsg()" style="padding:12px 16px;width:auto;">Send</button>
                </div>
            </div>

            <button class="svc-btn secondary" style="margin-top:12px;" onclick="closeSvcModal('ambassador-modal',null,true); document.getElementById('trust-modal').classList.add('open');">â† Back</button>
        </div>
    </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="conductor-portal" id="conductor-portal">
  <div class="conductor-inner">
    <div id="c-screen-login" class="c-screen active">
      <div class="c-login">
        <div class="c-badge">ðŸšŒ</div>
        <div class="c-title">Conductor Login</div>
        <div class="c-subtitle">Project Unified Â· Staff Portal</div>
        <div class="c-field-label">Staff ID</div>
        <input class="c-input" id="c-staff-id" type="text" placeholder="e.g. CD-047" autocomplete="off" oninput="checkLoginReady()" />
        <div class="c-field-label">4-Digit PIN</div>
        <div class="c-pin-wrap">
          <div class="c-pin-dot" id="cpd0">â€“</div>
          <div class="c-pin-dot" id="cpd1">â€“</div>
          <div class="c-pin-dot" id="cpd2">â€“</div>
          <div class="c-pin-dot" id="cpd3">â€“</div>
        </div>
        <div class="c-numpad">
          <div class="c-num-btn" onclick="cPinKey('1')">1</div><div class="c-num-btn" onclick="cPinKey('2')">2</div><div class="c-num-btn" onclick="cPinKey('3')">3</div>
          <div class="c-num-btn" onclick="cPinKey('4')">4</div><div class="c-num-btn" onclick="cPinKey('5')">5</div><div class="c-num-btn" onclick="cPinKey('6')">6</div>
          <div class="c-num-btn" onclick="cPinKey('7')">7</div><div class="c-num-btn" onclick="cPinKey('8')">8</div><div class="c-num-btn" onclick="cPinKey('9')">9</div>
          <div class="c-num-btn empty"></div><div class="c-num-btn" onclick="cPinKey('0')">0</div><div class="c-num-btn del" onclick="cPinDel()">âŒ«</div>
        </div>
        <button class="c-login-btn" id="c-login-btn" onclick="conductorLogin()" disabled>Login â†’</button>
        <div class="c-back-link" onclick="closeConductorPortal()">â† Back to App</div>
        <div class="c-demo-hint">Demo: CD-047 / 1234 &nbsp;Â·&nbsp; CD-012 / 5678 &nbsp;Â·&nbsp; or any ID + 4 digits</div>
      </div>
    </div>

    <div id="c-screen-profile" class="c-screen">
      <div class="c-topbar">
        <button class="c-tab-pill active" onclick="cShowTab('profile')">Profile</button>
        <button class="c-tab-pill" onclick="cShowTab('barcode')">Ticket</button>
        <button class="c-tab-pill" onclick="cShowTab('verify')">Verify</button>
        <button class="c-tab-pill" onclick="cShowTab('log')">Log</button>
        <button class="c-logout-btn" onclick="conductorLogout()">Logout</button>
      </div>

      <div class="c-tab active" id="ctab-profile">
        <div class="c-profile-hero">
          <div class="c-profile-avatar" id="cp-avatar-circle">JB</div>
          <div class="c-profile-name" id="cp-fullname">John Banda</div>
          <div class="c-profile-id" id="cp-staffid">CD-047</div>
          <div class="c-profile-status"><span class="c-status-dot"></span>On Duty</div>
        </div>
        <div class="c-profile-cards">
          <div class="c-profile-card"><div class="c-pc-icon">ðŸšŒ</div><div class="c-pc-val" id="cp-route">Bus 14A</div><div class="c-pc-key">Assigned Route</div></div>
          <div class="c-profile-card"><div class="c-pc-icon">ðŸ“</div><div class="c-pc-val" id="cp-zone">City Zone</div><div class="c-pc-key">Zone</div></div>
          <div class="c-profile-card"><div class="c-pc-icon">ðŸ“…</div><div class="c-pc-val" id="cp-shift">Morning</div><div class="c-pc-key">Shift</div></div>
          <div class="c-profile-card"><div class="c-pc-icon">â­</div><div class="c-pc-val" id="cp-rating">4.9</div><div class="c-pc-key">Rating</div></div>
        </div>
        <div class="c-info-block">
          <div class="c-info-row"><span class="c-info-key">Full Name</span><span class="c-info-val" id="cp-name2">John Banda</span></div>
          <div class="c-info-row"><span class="c-info-key">Staff ID</span><span class="c-info-val" id="cp-id2">CD-047</span></div>
          <div class="c-info-row"><span class="c-info-key">Phone</span><span class="c-info-val" id="cp-phone">+260 97 411 0047</span></div>
          <div class="c-info-row"><span class="c-info-key">Vehicle Reg</span><span class="c-info-val" id="cp-vehicle">ZM 4721 AB</span></div>
          <div class="c-info-row"><span class="c-info-key">License</span><span class="c-info-val" id="cp-license">PSV-2019-047</span></div>
          <div class="c-info-row"><span class="c-info-key">Joined</span><span class="c-info-val" id="cp-joined">Mar 2019</span></div>
        </div>
        <div class="c-shift-stats">
          <div class="c-ss-box"><div class="c-ss-val" id="css-verified">0</div><div class="c-ss-key">Boarded</div></div>
          <div class="c-ss-box"><div class="c-ss-val" id="css-rejected">0</div><div class="c-ss-key">Rejected</div></div>
          <div class="c-ss-box"><div class="c-ss-val" id="css-revenue">K 0</div><div class="c-ss-key">Revenue</div></div>
        </div>
        <button class="c-action-btn teal" onclick="cShowTab('barcode')">Generate Ticket Barcode â†’</button>
      </div>

      <div class="c-tab" id="ctab-barcode">
        <div class="c-section-title">ðŸŽ« Generate Ticket Barcode</div>
        <div class="c-bc-form">
          <div class="c-field-label">Route / Bus</div>
          <select class="c-select" id="bc-route-sel" onchange="bcRouteChanged()">
            <option value="Bus 14A|City Market|Chilenje|12.00">Bus 14A â€” City Market â†’ Chilenje</option>
            <option value="Bus 22B|Lusaka CBD|Matero|8.00">Bus 22B â€” Lusaka CBD â†’ Matero</option>
            <option value="Bus 08C|Kalingalinga|Kabulonga|15.00">Bus 08C â€” Kalingalinga â†’ Kabulonga</option>
            <option value="Bus 31D|Northmead|Chelstone|10.00">Bus 31D â€” Northmead â†’ Chelstone</option>
          </select>
          <div class="c-field-label">Departure Time</div>
          <input class="c-input" id="bc-time" type="time" value="14:30" />
          <div class="c-field-label">Seat Number</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:16px;">
            <input class="c-input" id="bc-seat" type="number" placeholder="e.g. 7" min="1" max="50" style="margin-bottom:0" />
            <div><div class="c-field-label" style="margin-bottom:4px;">Fare (K)</div><input class="c-input" id="bc-fare" type="number" placeholder="12.00" style="margin-bottom:0" /></div>
          </div>
          <button class="c-action-btn gold" onclick="generateBarcode()">Generate Barcode â†“</button>
        </div>
        <div class="c-bc-card" id="c-bc-card" style="display:none;">
          <div class="c-bc-card-header">
            <div><div class="c-bc-route" id="bc-display-route">Bus 14A</div><div class="c-bc-trip" id="bc-display-trip">City Market â†’ Chilenje</div></div>
            <div style="text-align:right;"><div class="c-bc-fare" id="bc-display-fare">K 12.00</div><div class="c-bc-time" id="bc-display-time">14:30</div></div>
          </div>
          <div class="c-bc-wrap"><svg id="bc-svg"></svg></div>
          <div class="c-bc-code-txt" id="bc-code-txt">PU-000000-14A</div>
          <div class="c-bc-meta"><span id="bc-meta-seat">Seat 07</span><span>Â·</span><span id="bc-meta-conductor">Conductor: John Banda</span><span>Â·</span><span id="bc-meta-date">Today</span></div>
          <div class="c-bc-hint">Passenger scans this barcode to pay &amp; board</div>
          <button class="c-action-btn teal" style="margin-top:12px;" onclick="regenerateBarcode()">â†» New Barcode</button>
        </div>
      </div>

      <div class="c-tab" id="ctab-verify">
        <div class="c-section-title">ðŸ”¢ Verify Passenger Code</div>
        <div class="c-verify-box">
          <div class="c-code-entry">
            <div class="c-digit active-digit" id="cd0"></div><div class="c-digit" id="cd1"></div><div class="c-digit" id="cd2"></div>
            <div class="c-digit" id="cd3"></div><div class="c-digit" id="cd4"></div><div class="c-digit" id="cd5"></div>
          </div>
          <div class="c-verify-numpad">
            <div class="cv-btn" onclick="cvKey('1')">1</div><div class="cv-btn" onclick="cvKey('2')">2</div><div class="cv-btn" onclick="cvKey('3')">3</div>
            <div class="cv-btn" onclick="cvKey('4')">4</div><div class="cv-btn" onclick="cvKey('5')">5</div><div class="cv-btn" onclick="cvKey('6')">6</div>
            <div class="cv-btn" onclick="cvKey('7')">7</div><div class="cv-btn" onclick="cvKey('8')">8</div><div class="cv-btn" onclick="cvKey('9')">9</div>
            <div class="cv-btn empty-v"></div><div class="cv-btn" onclick="cvKey('0')">0</div><div class="cv-btn del-v" onclick="cvDel()">âŒ«</div>
          </div>
          <button class="c-verify-btn" id="c-verify-btn" onclick="verifyCode()" disabled>Verify Code â†’</button>
        </div>
        <div class="c-result valid" id="c-result-valid" style="display:none;">
          <div class="c-result-icon">âœ…</div>
          <div class="c-result-title">Valid â€” Allow Boarding</div>
          <div class="c-result-detail">
            <div class="c-rd-item"><div class="c-rd-key">Passenger</div><div class="c-rd-val" id="cr-passenger">â€”</div></div>
            <div class="c-rd-item"><div class="c-rd-key">Route</div><div class="c-rd-val" id="cr-route">â€”</div></div>
            <div class="c-rd-item"><div class="c-rd-key">From</div><div class="c-rd-val" id="cr-from">â€”</div></div>
            <div class="c-rd-item"><div class="c-rd-key">To</div><div class="c-rd-val" id="cr-to">â€”</div></div>
            <div class="c-rd-item"><div class="c-rd-key">Seat</div><div class="c-rd-val" id="cr-seat">â€”</div></div>
            <div class="c-rd-item"><div class="c-rd-key">Fare Paid</div><div class="c-rd-val" id="cr-fare">â€”</div></div>
          </div>
        </div>
        <div class="c-result invalid" id="c-result-invalid" style="display:none;">
          <div class="c-result-icon">âŒ</div>
          <div class="c-result-title">Invalid or Expired Code</div>
          <div style="font-size:0.78rem;color:var(--text-muted);">Code not found. Ask passenger to pay again.</div>
        </div>
      </div>

      <div class="c-tab" id="ctab-log">
        <div class="c-section-title" style="display:flex;justify-content:space-between;align-items:center;">Boarding Log <span class="c-log-count" id="c-log-count">0 scans</span></div>
        <div id="c-log-list"><div class="c-log-empty" id="c-log-empty">No verifications yet</div></div>
      </div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                    STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let balance = 0.00;
let tries = 3;
let activeCodes = {};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                 NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(pageId, tabEl) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
    const page = document.getElementById(pageId);
    if (page) page.classList.add('active');
    if (tabEl) tabEl.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  WALLET / TOP-UP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openTopUp() {
    document.getElementById('topup-modal').classList.add('open');
    document.getElementById('topup-input').value = '';
    document.querySelectorAll('.amount-chip').forEach(c => c.classList.remove('selected'));
}
function closeTopUp() { document.getElementById('topup-modal').classList.remove('open'); }
function handleModalClick(e) { if (e.target === document.getElementById('topup-modal')) closeTopUp(); }
function setAmount(val) {
    document.getElementById('topup-input').value = val;
    document.querySelectorAll('.amount-chip').forEach(c => c.classList.toggle('selected', c.textContent.includes(val)));
}
function confirmTopUp() {
    const val = parseFloat(document.getElementById('topup-input').value);
    if (!val || val <= 0) { showToast('Please enter a valid amount'); return; }
    balance += val;
    updateBalance();
    closeTopUp();
    addActivity('ðŸ’³', `K ${val.toFixed(2)} added to wallet`, 'Just now', 'gold');
    showToast(`âœ“ K ${val.toFixed(2)} added successfully`);
}
function updateBalance() { document.getElementById('balance-display').textContent = balance.toFixed(2); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  ACTIVITY FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addActivity(icon, label, desc, color) {
    const feed = document.getElementById('activity-feed');
    const item = document.createElement('div');
    item.className = 'action-row';
    item.style.cursor = 'default';
    item.innerHTML = `<div class="action-icon-wrap ${color}">${icon}</div><div class="action-text"><div class="action-label">${label}</div><div class="action-desc">${desc}</div></div>`;
    feed.insertBefore(item, feed.firstChild);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openNotifications() {
    document.getElementById('notif-modal').classList.add('open');
    document.getElementById('notif-dot').style.display = 'none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let toastTimer;
function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => t.classList.remove('show'), 2800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//               SERVICE MODAL HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function closeSvcModal(id, e, force) {
    if (force || !e || e.target === document.getElementById(id)) {
        document.getElementById(id).classList.remove('open');
    }
}
function showLoading(id) { const el = document.getElementById(id); if(el) { el.classList.add('show'); el.style.display = 'block'; } }
function hideLoading(id) { const el = document.getElementById(id); if(el) { el.classList.remove('show'); el.style.display = 'none'; } }
function showResult(id) { const el = document.getElementById(id); if(el) el.style.display = 'block'; }
function hideResult(id) { const el = document.getElementById(id); if(el) el.style.display = 'none'; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                 TICKET FLOW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ticketRoutes = [
    { from: 'City Market',  to: 'Chilenje',   bus: 'Bus 14A', seat: 'Seat 07', time: '14:30', fare: '12.00' },
    { from: 'Lusaka CBD',   to: 'Matero',     bus: 'Bus 22B', seat: 'Seat 12', time: '15:05', fare: '8.00'  },
    { from: 'Kalingalinga', to: 'Kabulonga',  bus: 'Bus 08C', seat: 'Seat 03', time: '14:45', fare: '15.00' },
    { from: 'Northmead',    to: 'Chelstone',  bus: 'Bus 31D', seat: 'Seat 09', time: '14:55', fare: '10.00' },
];
let currentTicket = null, selectedMomo = 'airtel', codeTimer = null, codeSeconds = 1800;

function openTicketScanner() {
    resetTicketModal();
    document.getElementById('ticket-modal').classList.add('open');
}
function resetTicketModal() {
    document.querySelectorAll('.ticket-step').forEach(s => s.classList.remove('active'));
    document.getElementById('step-scan').classList.add('active');
    selectedMomo = 'airtel';
    document.querySelectorAll('.momo-option').forEach(o => o.classList.remove('selected'));
    document.getElementById('momo-airtel').classList.add('selected');
    document.getElementById('phone-field').style.display = 'block';
    document.getElementById('phone-input').value = '';
    if (codeTimer) { clearInterval(codeTimer); codeTimer = null; }
}
function handleTicketModalClick(e) { if (e.target === document.getElementById('ticket-modal')) closeTicketModal(); }
function closeTicketModal() { document.getElementById('ticket-modal').classList.remove('open'); if (codeTimer) { clearInterval(codeTimer); codeTimer = null; } }
function simulateScan() {
    currentTicket = ticketRoutes[Math.floor(Math.random() * ticketRoutes.length)];
    document.getElementById('tc-from').textContent = currentTicket.from;
    document.getElementById('tc-to').textContent   = currentTicket.to;
    document.getElementById('tc-bus').textContent  = currentTicket.bus;
    document.getElementById('tc-seat').textContent = currentTicket.seat;
    document.getElementById('tc-time').textContent = currentTicket.time;
    document.getElementById('tc-fare').textContent = currentTicket.fare;
    showTicketStep('step-pay');
    showToast('âœ“ QR Code Detected!');
}
function selectMomo(provider) {
    selectedMomo = provider;
    document.querySelectorAll('.momo-option').forEach(o => o.classList.remove('selected'));
    document.getElementById('momo-' + provider).classList.add('selected');
    document.getElementById('phone-field').style.display = provider === 'wallet' ? 'none' : 'block';
}
function confirmPayment() {
    const phone = document.getElementById('phone-input').value.trim();
    if (selectedMomo !== 'wallet' && phone.length < 9) { showToast('Please enter a valid mobile number'); return; }
    if (selectedMomo === 'wallet' && balance < parseFloat(currentTicket.fare)) { showToast('Insufficient wallet balance â€“ please top up'); return; }
    const providerNames = { airtel: 'Airtel Money', mtn: 'MTN Money', zamtel: 'Zamtel Kwacha', wallet: 'PU Wallet' };
    document.getElementById('processing-sub-text').textContent = 'Connecting to ' + providerNames[selectedMomo] + 'â€¦';
    showTicketStep('step-processing');
    setTimeout(() => {
        if (selectedMomo === 'wallet') { balance -= parseFloat(currentTicket.fare); updateBalance(); }
        const code = String(Math.floor(100000 + Math.random() * 900000));
        document.getElementById('conductor-code-display').textContent = code;
        activeCodes[code] = Object.assign({}, currentTicket);
        document.getElementById('bc-from').textContent = currentTicket.from;
        document.getElementById('bc-to').textContent   = currentTicket.to;
        document.getElementById('bc-bus').textContent  = currentTicket.bus;
        document.getElementById('bc-fare').textContent = 'K ' + currentTicket.fare;
        codeSeconds = 1800; updateCodeTimer();
        codeTimer = setInterval(() => { codeSeconds--; if (codeSeconds <= 0) { clearInterval(codeTimer); document.getElementById('code-expires-txt').textContent = 'Code Expired'; return; } updateCodeTimer(); }, 1000);
        showTicketStep('step-code');
        addActivity('ðŸŽ«', `Bus ticket purchased â€” ${currentTicket.bus}`, `${currentTicket.from} â†’ ${currentTicket.to} Â· K ${currentTicket.fare}`, 'gold');
    }, 2400);
}
function updateCodeTimer() {
    const m = Math.floor(codeSeconds / 60).toString().padStart(2, '0');
    const s = (codeSeconds % 60).toString().padStart(2, '0');
    document.getElementById('code-expires-txt').textContent = 'Expires in ' + m + ':' + s;
}
function showTicketStep(stepId) {
    document.querySelectorAll('.ticket-step').forEach(s => s.classList.remove('active'));
    document.getElementById(stepId).classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  FUEL SERVICE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openFuelModal() {
    hideResult('fuel-result');
    hideLoading('fuel-loading');
    document.getElementById('fuel-submit-btn').disabled = false;
    document.getElementById('fuel-submit-btn').style.display = 'block';
    document.getElementById('fuel-modal').classList.add('open');
}
function submitFuelOrder() {
    const loc = document.getElementById('fuel-location').value.trim();
    if (!loc) { showToast('Please enter your delivery location'); return; }
    const qty = document.getElementById('fuel-qty').value;
    const qtyNum = qty + 'L';
    const qtyVal = parseInt(qty);
    const total = qtyVal * 28 + 25;
    document.getElementById('fuel-submit-btn').style.display = 'none';
    showLoading('fuel-loading');
    const drivers = ['Chanda M.', 'Mwila B.', 'Amos K.', 'Pious N.'];
    setTimeout(() => {
        hideLoading('fuel-loading');
        document.getElementById('fuel-driver').textContent = drivers[Math.floor(Math.random() * drivers.length)];
        document.getElementById('fuel-qty-result').textContent = qtyNum;
        document.getElementById('fuel-total').textContent = 'K ' + total;
        showResult('fuel-result');
        addActivity('â›½', `Fuel order placed â€” ${qtyNum}`, `Delivery to ${loc} Â· K ${total}`, 'orange');
        showToast('â›½ Fuel driver dispatched!');
    }, 2200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                MECHANIC SERVICE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openMechanicModal() {
    hideResult('mech-result');
    hideLoading('mech-loading');
    document.getElementById('mechanic-modal').classList.add('open');
}
function bookMechanic(name, spec, rating, dist, rate) {
    hideResult('mech-result');
    showLoading('mech-loading');
    setTimeout(() => {
        hideLoading('mech-loading');
        document.getElementById('mech-name-result').textContent = name;
        document.getElementById('mech-spec-result').textContent = spec;
        document.getElementById('mech-rate-result').textContent = rate;
        showResult('mech-result');
        addActivity('ðŸ”§', `Mechanic booked â€” ${name}`, `${spec} Â· ETA ~15 min`, 'teal');
        showToast('ðŸ”§ Mechanic on the way!');
    }, 1800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//              SWAP & INSURANCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let selectedPlan = null;
function openSwapModal() {
    selectedPlan = null;
    hideResult('swap-result');
    document.getElementById('plan-basic-check').style.display = 'none';
    document.getElementById('plan-pro-check').style.display = 'none';
    document.getElementById('plan-basic').style.borderColor = '';
    document.getElementById('plan-pro').style.borderColor = 'rgba(240,192,64,0.3)';
    document.getElementById('swap-modal').classList.add('open');
}
function selectInsurancePlan(el, plan) {
    selectedPlan = plan;
    document.getElementById('plan-basic-check').style.display = plan === 'basic' ? 'block' : 'none';
    document.getElementById('plan-pro-check').style.display   = plan === 'pro'   ? 'block' : 'none';
    document.getElementById('plan-basic').style.borderColor = plan === 'basic' ? 'rgba(52,211,153,0.5)' : '';
    document.getElementById('plan-pro').style.borderColor   = plan === 'pro'   ? 'rgba(52,211,153,0.5)' : 'rgba(240,192,64,0.3)';
}
function activateInsurance() {
    if (!selectedPlan) { showToast('Please select a plan first'); return; }
    const names = { basic: 'Basic Cover Â· K 89/mo', pro: 'Pro Cover Â· K 199/mo' };
    document.getElementById('swap-plan-name').textContent = names[selectedPlan];
    showResult('swap-result');
    addActivity('ðŸ›¡ï¸', 'Insurance activated', names[selectedPlan], 'gold');
    showToast('âœ“ Insurance plan activated!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//                  JOB CONNECT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function useTry() { openJobModal({ title: 'Apply for New Role', company: 'General Application', salary: 'Varies', type: 'Full-Time', location: 'Lusaka', exp: 'Open', desc: 'Submit a general application to be matched with available roles across our vendor network.' }); }
function openJobModal(job) {
    hideResult('job-result');
    hideLoading('job-loading');
    document.getElementById('job-modal-title').textContent = job.title;
    document.getElementById('job-modal-company').textContent = job.company;
    document.getElementById('job-modal-desc').textContent = job.desc;
    document.getElementById('job-modal-salary').textContent = job.salary;
    document.getElementById('job-modal-location').textContent = job.location;
    document.getElementById('job-modal-exp').textContent = job.exp;
    const tagsEl = document.getElementById('job-modal-tags');
    tagsEl.innerHTML = `<span class="svc-tag gold">${job.type}</span><span class="svc-tag teal">${job.location}</span>`;
    document.getElementById('job-apply-btn').style.display = 'block';
    document.getElementById('job-apply-btn').disabled = false;
    document.getElementById('job-name').value = '';
    document.getElementById('job-phone').value = '';
    document.getElementById('job-why').value = '';
    document.getElementById('job-modal').classList.add('open');
    // store current job
    document.getElementById('job-modal').dataset.jobTitle = job.title;
    document.getElementById('job-modal').dataset.jobCompany = job.company;
}
function submitJobApplication() {
    const name  = document.getElementById('job-name').value.trim();
    const phone = document.getElementById('job-phone').value.trim();
    const why   = document.getElementById('job-why').value.trim();
    if (!name)  { showToast('Please enter your name'); return; }
    if (!phone) { showToast('Please enter your phone number'); return; }
    if (tries <= 0) { showToast('No free tries remaining â€” upgrade for K200'); return; }

    document.getElementById('job-apply-btn').style.display = 'none';
    showLoading('job-loading');

    setTimeout(() => {
        tries--;
        const dots = document.querySelectorAll('.tries-dot');
        if (dots[tries]) dots[tries].classList.add('used');
        document.getElementById('tries-display').textContent = tries;
        const ref = 'JC-' + String(Math.floor(10000 + Math.random() * 90000));
        document.getElementById('job-ref').textContent = ref;
        document.getElementById('job-tries-left').textContent = tries + ' remaining';
        hideLoading('job-loading');
        showResult('job-result');
        const jobTitle = document.getElementById('job-modal').dataset.jobTitle;
        const jobCo    = document.getElementById('job-modal').dataset.jobCompany;
        addActivity('ðŸ“', `Applied: ${jobTitle}`, `${jobCo} Â· Ref ${ref}`, 'gold');
        document.getElementById('home-jobs-count').textContent = Math.max(1, 7 - (3 - tries));
        showToast('âœ“ Application sent!');
    }, 2000);
}
function openVendorDirectory() { document.getElementById('vendor-modal').classList.add('open'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//               CARGO / LOGISTICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openPickupModal() {
    hideResult('pickup-result'); hideLoading('pickup-loading');
    document.getElementById('pickup-btn').style.display = 'block';
    document.getElementById('pickup-btn').disabled = false;
    document.getElementById('pickup-modal').classList.add('open');
    const now = new Date(); now.setHours(now.getHours() + 2);
    document.getElementById('pickup-time').value = now.toISOString().slice(0,16);
}
function schedulePickup() {
    const loc = document.getElementById('pickup-location').value.trim();
    const dest = document.getElementById('pickup-dest').value.trim();
    if (!loc || !dest) { showToast('Please enter pickup location and destination'); return; }
    document.getElementById('pickup-btn').style.display = 'none';
    showLoading('pickup-loading');
    setTimeout(() => {
        hideLoading('pickup-loading');
        const ref = 'ZM-' + String(Math.floor(1000 + Math.random() * 9000));
        document.getElementById('pickup-ref').textContent = ref;
        showResult('pickup-result');
        addActivity('ðŸš›', `Cargo pickup scheduled`, `${loc} â†’ ${dest} Â· Ref ${ref}`, 'teal');
        showToast('ðŸ“¦ Pickup scheduled â€” driver assigned!');
    }, 2000);
}
function openRouteModal() {
    hideResult('route-result'); hideLoading('route-loading');
    document.getElementById('route-btn').style.display = 'block';
    document.getElementById('route-modal').classList.add('open');
}
function calcRoute() {
    document.getElementById('route-btn').style.display = 'none';
    showLoading('route-loading');
    const routes = {
        'Lusaka Industrial Area|Kitwe Copper Belt': { dist: '312 km', eta: '4h 20min', toll: 'K 85', fuel: 'K 420' },
        'Lusaka Industrial Area|Ndola Industrial':  { dist: '325 km', eta: '4h 35min', toll: 'K 90', fuel: 'K 440' },
        'City Market Lusaka|Livingstone South':      { dist: '472 km', eta: '6h 10min', toll: 'K 120', fuel: 'K 630' },
        'Chilenje Market|Kabwe Central':             { dist: '142 km', eta: '1h 55min', toll: 'K 30', fuel: 'K 190' },
    };
    const from = document.getElementById('route-from').value;
    const to   = document.getElementById('route-to').value;
    const key  = from + '|' + to;
    const data = routes[key] || { dist: Math.floor(150 + Math.random()*300) + ' km', eta: Math.floor(2 + Math.random()*4) + 'h ' + Math.floor(10+Math.random()*50) + 'min', toll: 'K ' + Math.floor(40+Math.random()*100), fuel: 'K ' + Math.floor(200+Math.random()*400) };
    setTimeout(() => {
        hideLoading('route-loading');
        document.getElementById('route-dist').textContent = data.dist;
        document.getElementById('route-eta').textContent  = data.eta;
        document.getElementById('route-toll').textContent = data.toll;
        document.getElementById('route-fuel').textContent = data.fuel;
        showResult('route-result');
        showToast('ðŸ—ºï¸ Route calculated!');
    }, 1800);
}
function openTrackModal() {
    hideResult('track-result'); hideResult('track-notfound'); hideLoading('track-loading');
    document.getElementById('track-btn').style.display = 'block';
    document.getElementById('track-modal').classList.add('open');
}
function trackShipment() {
    const num = document.getElementById('track-number').value.trim();
    if (!num) { showToast('Enter a tracking number'); return; }
    document.getElementById('track-btn').style.display = 'none';
    showLoading('track-loading');
    const knownShipments = {
        'ZM-2847': { status: 'In Transit', location: 'Kapiri Mposhi â€” 128km to Kitwe', eta: 'Today 14:30', driver: 'Mwape C.' },
        'ZM-1234': { status: 'Delivered', location: 'Ndola Industrial Park', eta: 'Delivered 09:45', driver: 'Bwalya T.' },
        'ZM-9999': { status: 'Pickup Pending', location: 'Lusaka Industrial Area', eta: 'Tomorrow 08:00', driver: 'Assigningâ€¦' },
    };
    setTimeout(() => {
        hideLoading('track-loading');
        const data = knownShipments[num.toUpperCase()];
        if (data) {
            document.getElementById('track-status').textContent   = data.status;
            document.getElementById('track-location').textContent = data.location;
            document.getElementById('track-eta').textContent      = data.eta;
            document.getElementById('track-driver').textContent   = data.driver;
            document.getElementById('track-status-title').textContent = `Shipment ${num.toUpperCase()} Found`;
            showResult('track-result');
        } else if (num.toUpperCase().startsWith('ZM-')) {
            document.getElementById('track-status').textContent   = 'Processing';
            document.getElementById('track-location').textContent = 'Lusaka Depot';
            document.getElementById('track-eta').textContent      = 'Est. Tomorrow';
            document.getElementById('track-driver').textContent   = 'Pending';
            document.getElementById('track-status-title').textContent = `Shipment ${num.toUpperCase()}`;
            showResult('track-result');
        } else {
            showResult('track-notfound');
        }
        document.getElementById('track-btn').style.display = 'block';
    }, 1600);
}
function openPromoCredits() {
    balance += 50;
    updateBalance();
    addActivity('ðŸŽ', 'Promo credits applied â€” K 50', 'Delivery credit added to wallet', 'orange');
    showToast('ðŸŽ K 50 delivery credit added to wallet!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//              TRUST & SUPPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openTrustModal() { document.getElementById('trust-modal').classList.add('open'); }
function openMediationModal() {
    document.getElementById('trust-modal').classList.remove('open');
    hideResult('dispute-result'); hideLoading('dispute-loading');
    document.getElementById('dispute-btn').style.display = 'block';
    setTimeout(() => document.getElementById('mediation-modal').classList.add('open'), 300);
}
function fileDispute() {
    const desc = document.getElementById('dispute-desc').value.trim();
    if (!desc) { showToast('Please describe the issue'); return; }
    document.getElementById('dispute-btn').style.display = 'none';
    showLoading('dispute-loading');
    setTimeout(() => {
        hideLoading('dispute-loading');
        const caseId = 'CASE-' + String(Math.floor(10000 + Math.random() * 90000));
        document.getElementById('dispute-case').textContent = caseId;
        showResult('dispute-result');
        showToast('âš–ï¸ Dispute filed â€” Case ' + caseId);
    }, 1800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//             CONDUCTOR PORTAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const conductorAccounts = [
    { id:'CD-047', pin:'1234', name:'John Banda',   route:'Bus 14A', zone:'City Zone',  shift:'Morning',   phone:'+260 97 411 0047', vehicle:'ZM 4721 AB', license:'PSV-2019-047', joined:'Mar 2019', rating:'4.9', initials:'JB' },
    { id:'CD-012', pin:'5678', name:'Mary Phiri',   route:'Bus 22B', zone:'North Zone', shift:'Afternoon', phone:'+260 96 200 0012', vehicle:'ZM 3310 CD', license:'PSV-2020-012', joined:'Jan 2020', rating:'4.8', initials:'MP' },
    { id:'CD-099', pin:'0000', name:'Peter Mwale',  route:'Bus 08C', zone:'East Zone',  shift:'Evening',   phone:'+260 95 300 0099', vehicle:'ZM 5588 EF', license:'PSV-2018-099', joined:'Jun 2018', rating:'4.7', initials:'PM' },
    { id:'CD-031', pin:'9999', name:'Grace Tembo',  route:'Bus 31D', zone:'South Zone', shift:'Morning',   phone:'+260 97 500 0031', vehicle:'ZM 1122 GH', license:'PSV-2021-031', joined:'Sep 2021', rating:'5.0', initials:'GT' },
];
let cPin = '', conductorProfile = null;
let cVerified = 0, cRejected = 0, cRevenue = 0;
let cvCode = '';

function openConductorPortal() {
    cPin = ''; renderCPin();
    document.getElementById('c-staff-id').value = '';
    document.getElementById('c-login-btn').disabled = true;
    cShowScreen('c-screen-login');
    document.getElementById('conductor-portal').classList.add('open');
}
function closeConductorPortal() { document.getElementById('conductor-portal').classList.remove('open'); }
function cShowScreen(id) { document.querySelectorAll('.c-screen').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); }
function cPinKey(d) { if (cPin.length >= 4) return; cPin += d; renderCPin(); checkLoginReady(); }
function cPinDel() { cPin = cPin.slice(0,-1); renderCPin(); checkLoginReady(); }
function renderCPin() {
    for (let i = 0; i < 4; i++) {
        const el = document.getElementById('cpd'+i);
        if (i < cPin.length) { el.textContent='â—'; el.classList.add('filled'); }
        else { el.textContent='â€“'; el.classList.remove('filled'); }
    }
}
function checkLoginReady() {
    const id = document.getElementById('c-staff-id').value.trim();
    document.getElementById('c-login-btn').disabled = !(id.length >= 2 && cPin.length === 4);
}
function conductorLogin() {
    const inputId = document.getElementById('c-staff-id').value.trim();
    const inputPin = cPin;
    const match = conductorAccounts.find(a => a.id.toLowerCase() === inputId.toLowerCase() && a.pin === inputPin);
    if (match) {
        conductorProfile = match;
    } else if (inputId.length >= 2 && inputPin.length === 4) {
        conductorProfile = { id:inputId, pin:inputPin, name:inputId, route:'All Routes', zone:'General', shift:'All Day', phone:'N/A', vehicle:'N/A', license:'N/A', joined:'Today', rating:'â€”', initials:inputId.slice(0,2).toUpperCase() };
    } else {
        showToast('Invalid credentials'); return;
    }
    cVerified=0; cRejected=0; cRevenue=0; cvCode='';
    renderCvDigits();
    document.getElementById('c-result-valid').style.display='none';
    document.getElementById('c-result-invalid').style.display='none';
    document.getElementById('c-log-list').innerHTML='<div class="c-log-empty" id="c-log-empty">No verifications yet</div>';
    updateCStats();
    populateConductorProfile();
    cShowScreen('c-screen-profile');
    cShowTab('profile');
}
function conductorLogout() {
    cPin=''; renderCPin();
    document.getElementById('c-staff-id').value='';
    document.getElementById('c-login-btn').disabled=true;
    cShowScreen('c-screen-login');
}
function populateConductorProfile() {
    const p = conductorProfile;
    document.getElementById('cp-avatar-circle').textContent = p.initials;
    document.getElementById('cp-fullname').textContent = p.name;
    document.getElementById('cp-staffid').textContent  = p.id;
    document.getElementById('cp-route').textContent    = p.route;
    document.getElementById('cp-zone').textContent     = p.zone;
    document.getElementById('cp-shift').textContent    = p.shift;
    document.getElementById('cp-rating').textContent   = p.rating;
    document.getElementById('cp-name2').textContent    = p.name;
    document.getElementById('cp-id2').textContent      = p.id;
    document.getElementById('cp-phone').textContent    = p.phone;
    document.getElementById('cp-vehicle').textContent  = p.vehicle;
    document.getElementById('cp-license').textContent  = p.license;
    document.getElementById('cp-joined').textContent   = p.joined;
    const sel = document.getElementById('bc-route-sel');
    for (let i=0; i<sel.options.length; i++) {
        if (sel.options[i].value.startsWith(p.route)) { sel.selectedIndex=i; break; }
    }
    bcRouteChanged();
}
function cShowTab(tab) {
    document.querySelectorAll('.c-tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.c-tab-pill').forEach(t=>t.classList.remove('active'));
    document.getElementById('ctab-'+tab).classList.add('active');
    document.querySelectorAll('.c-tab-pill').forEach(t=>{
        if(t.getAttribute('onclick') && t.getAttribute('onclick').includes("'"+tab+"'")) t.classList.add('active');
    });
}
function bcRouteChanged() {
    const parts = document.getElementById('bc-route-sel').value.split('|');
    document.getElementById('bc-fare').value = parts[3]||'12.00';
}
function generateBarcode() {
    const parts  = document.getElementById('bc-route-sel').value.split('|');
    const bus=parts[0], from=parts[1], to=parts[2];
    const fare   = document.getElementById('bc-fare').value || parts[3];
    const time   = document.getElementById('bc-time').value || '14:30';
    const seat   = document.getElementById('bc-seat').value || '1';
    const seq    = String(Math.floor(100000+Math.random()*900000));
    const busCode= bus.replace('Bus ','').replace(' ','');
    const barcodeVal = 'PU-'+seq+'-'+busCode;
    const today  = new Date().toLocaleDateString('en-GB',{day:'2-digit',month:'short',year:'numeric'});
    activeCodes[seq] = { from, to, bus, seat:'Seat '+seat, time, fare };
    document.getElementById('bc-display-route').textContent = bus;
    document.getElementById('bc-display-trip').textContent  = from+' â†’ '+to;
    document.getElementById('bc-display-fare').textContent  = 'K '+parseFloat(fare).toFixed(2);
    document.getElementById('bc-display-time').textContent  = time;
    document.getElementById('bc-code-txt').textContent      = barcodeVal;
    document.getElementById('bc-meta-seat').textContent     = 'Seat '+seat;
    document.getElementById('bc-meta-conductor').textContent= 'Conductor: '+conductorProfile.name;
    document.getElementById('bc-meta-date').textContent     = today;
    try {
        JsBarcode('#bc-svg', barcodeVal, { format:'CODE128', width:2.2, height:80, displayValue:false, background:'#ffffff', lineColor:'#111111', margin:0 });
    } catch(e) {
        const svg=document.getElementById('bc-svg');
        svg.setAttribute('viewBox','0 0 300 80');
        svg.innerHTML='<rect width="300" height="80" fill="#eee"/><text x="50%" y="50%" text-anchor="middle" fill="#333" font-size="12">'+barcodeVal+'</text>';
    }
    document.getElementById('c-bc-card').style.display='block';
    showToast('âœ“ Barcode generated for '+bus);
}
function regenerateBarcode() { document.getElementById('bc-seat').value = String(Math.floor(Math.random()*50)+1); generateBarcode(); }

function cvKey(d) { if (cvCode.length >= 6) return; cvCode += d; renderCvDigits(); document.getElementById('c-verify-btn').disabled = cvCode.length < 6; }
function cvDel() {
    cvCode = cvCode.slice(0,-1); renderCvDigits();
    document.getElementById('c-verify-btn').disabled = cvCode.length < 6;
    document.getElementById('c-result-valid').style.display='none';
    document.getElementById('c-result-invalid').style.display='none';
}
function renderCvDigits() {
    for (let i=0; i<6; i++) {
        const el=document.getElementById('cd'+i);
        if (i<cvCode.length) { el.textContent=cvCode[i]; el.classList.add('filled-digit'); el.classList.remove('active-digit'); }
        else { el.textContent=''; el.classList.remove('filled-digit'); el.classList.toggle('active-digit',i===cvCode.length); }
    }
}
function verifyCode() {
    const data=activeCodes[cvCode];
    document.getElementById('c-result-valid').style.display='none';
    document.getElementById('c-result-invalid').style.display='none';
    const names=['M. Banda','P. Mwale','A. Tembo','G. Phiri','F. Zulu','T. Mulenga'];
    if (data) {
        document.getElementById('cr-passenger').textContent=names[Math.floor(Math.random()*names.length)];
        document.getElementById('cr-route').textContent=data.bus;
        document.getElementById('cr-from').textContent=data.from;
        document.getElementById('cr-to').textContent=data.to;
        document.getElementById('cr-seat').textContent=data.seat;
        document.getElementById('cr-fare').textContent='K '+data.fare;
        document.getElementById('c-result-valid').style.display='block';
        cVerified++; cRevenue+=parseFloat(data.fare);
        addLogEntry(cvCode,data.from+' â†’ '+data.to,'ok');
        delete activeCodes[cvCode];
    } else {
        document.getElementById('c-result-invalid').style.display='block';
        cRejected++; addLogEntry(cvCode,'Unknown','bad');
    }
    updateCStats();
    setTimeout(()=>{ cvCode=''; renderCvDigits(); document.getElementById('c-verify-btn').disabled=true;
        document.getElementById('c-result-valid').style.display='none';
        document.getElementById('c-result-invalid').style.display='none';
    },3500);
}
function addLogEntry(code,route,status) {
    const empty=document.getElementById('c-log-empty'); if(empty) empty.remove();
    const list=document.getElementById('c-log-list');
    const item=document.createElement('div'); item.className='c-log-item';
    item.innerHTML=`<div class="c-log-dot ${status}"></div><div class="c-log-code">${code}</div><div class="c-log-route">${route}</div><div class="c-log-status ${status}">${status==='ok'?'Boarded':'Rejected'}</div>`;
    list.prepend(item);
    const total=cVerified+cRejected;
    document.getElementById('c-log-count').textContent=total+' scan'+(total!==1?'s':'');
}
function updateCStats() {
    document.getElementById('css-verified').textContent=cVerified;
    document.getElementById('css-rejected').textContent=cRejected;
    document.getElementById('css-revenue').textContent='K '+cRevenue.toFixed(0);
}

// â•â• Init â•â•
window.onload = () => {
    updateBalance();
    document.getElementById('c-staff-id').addEventListener('input', checkLoginReady);
    const now = new Date();
    const h = now.getHours(), m = now.getMinutes().toString().padStart(2,'0');
    document.getElementById('bc-time').value = `${String(h).padStart(2,'0')}:${m}`;
    renderVaultDocs();
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//              VENDOR DIRECTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const vendorData = [
    { id:1, name:'Lusaka City Transport', cat:'transport', icon:'ðŸšŒ', bg:'rgba(240,192,64,0.12)', rating:'4.8â˜…', location:'CBD, Lusaka', contact:'+260 211 220 011', hours:'05:00â€“22:00', desc:'Operating 18 bus routes across Lusaka with 40+ vehicles. Hiring drivers, conductors and admin staff.', jobs:['Bus Driver Â· K 4,500/mo','Route Supervisor Â· K 6,000/mo'] },
    { id:2, name:'ZamFreight Logistics', cat:'logistics', icon:'ðŸ“¦', bg:'rgba(45,212,191,0.10)', rating:'4.6â˜…', location:'Industrial Area', contact:'+260 211 255 300', hours:'06:00â€“20:00', desc:'National freight forwarding and warehousing. 3 depots across Lusaka, Kitwe and Ndola.', jobs:['Warehouse Supervisor Â· K 6,200/mo','Forklift Operator Â· K 4,000/mo','Dispatcher Â· K 3,500/mo'] },
    { id:3, name:'RoadFix Auto Centre', cat:'mechanical', icon:'ðŸ”§', bg:'rgba(249,115,22,0.10)', rating:'4.9â˜…', location:'Chilenje, Lusaka', contact:'+260 96 411 2200', hours:'07:00â€“18:00', desc:'Full mechanical workshop: engine, brakes, suspension, electrical. 8 certified mechanics on-site.', jobs:['Auto Mechanic Â· K 3,800/mo','Apprentice Mechanic Â· K 1,800/mo'] },
    { id:4, name:'ZamEnergy Fuel Network', cat:'fuel', icon:'â›½', bg:'rgba(240,192,64,0.12)', rating:'4.5â˜…', location:'6 stations citywide', contact:'+260 211 230 500', hours:'24/7', desc:'Fuel retail and on-demand delivery. Petrol, diesel and LPG available at all stations.', jobs:['Fuel Attendant Â· K 2,400/mo','Station Supervisor Â· K 4,200/mo'] },
    { id:5, name:'Shoprite Zambia', cat:'retail', icon:'ðŸ›’', bg:'rgba(248,113,113,0.10)', rating:'4.3â˜…', location:'Multiple locations', contact:'+260 211 248 000', hours:'08:00â€“21:00', desc:'Leading supermarket chain. Hiring cashiers, packers, floor supervisors and store managers.', jobs:['Cashier Â· K 2,200/mo','Floor Supervisor Â· K 3,600/mo'] },
    { id:6, name:'Indo Zambia Bank', cat:'finance', icon:'ðŸ’°', bg:'rgba(52,211,153,0.10)', rating:'4.7â˜…', location:'Cairo Road, Lusaka', contact:'+260 211 228 000', hours:'08:00â€“15:30 Monâ€“Fri', desc:'Commercial banking services, SME loans and mobile banking. Offers business accounts for vendors.', jobs:['Bank Teller Â· K 5,500/mo','Loans Officer Â· K 7,000/mo'] },
    { id:7, name:'AutoRelief Mechanics', cat:'mechanical', icon:'ðŸ”©', bg:'rgba(45,212,191,0.10)', rating:'4.8â˜…', location:'Northmead, Lusaka', contact:'+260 97 500 4455', hours:'07:30â€“17:30', desc:'Specialised in commercial vehicles and PSV buses. Fleet maintenance contracts available.', jobs:['Heavy Vehicle Mechanic Â· K 5,000/mo'] },
    { id:8, name:'Proflight Zambia', cat:'transport', icon:'âœˆï¸', bg:'rgba(240,192,64,0.12)', rating:'4.6â˜…', location:'KK Int\'l Airport', contact:'+260 211 271 032', hours:'24/7', desc:'National airline connecting Lusaka, Livingstone, Ndola, Mfuwe and regional destinations.', jobs:['Ground Crew Â· K 4,800/mo','Passenger Agent Â· K 4,200/mo'] },
    { id:9, name:'Choppies Enterprises', cat:'retail', icon:'ðŸª', bg:'rgba(249,115,22,0.10)', rating:'4.2â˜…', location:'Matero, Lusaka', contact:'+260 211 294 100', hours:'08:00â€“20:00', desc:'Affordable grocery retail. Community-focused stores across low- and mid-income areas.', jobs:['Shelf Packer Â· K 1,900/mo','Supervisor Â· K 3,200/mo'] },
    { id:10, name:'Atlas Mara Zambia', cat:'finance', icon:'ðŸ¦', bg:'rgba(52,211,153,0.10)', rating:'4.5â˜…', location:'Lusaka CBD', contact:'+260 211 366 400', hours:'08:00â€“15:00 Monâ€“Fri', desc:'Retail and corporate banking. Mobile money integration and SME finance for informal traders.', jobs:['Financial Analyst Â· K 8,500/mo','SME Advisor Â· K 6,800/mo'] },
];
let currentVendorFilter = 'all';

function openVendorDirectory() {
    currentVendorFilter = 'all';
    document.querySelectorAll('.vendor-cat-pill').forEach((p,i) => p.classList.toggle('active', i===0));
    renderVendors('all');
    document.getElementById('vendor-modal').classList.add('open');
}
function filterVendors(cat) {
    currentVendorFilter = cat;
    document.querySelectorAll('.vendor-cat-pill').forEach(p => {
        const matches = (cat==='all' && p.textContent.trim()==='All') || p.getAttribute('onclick').includes("'"+cat+"'");
        p.classList.toggle('active', matches);
    });
    renderVendors(cat);
}
function renderVendors(cat) {
    const list = document.getElementById('vendor-list');
    const filtered = cat==='all' ? vendorData : vendorData.filter(v => v.cat===cat);
    list.innerHTML = filtered.length ? '' : '<div style="text-align:center;padding:20px;font-size:0.8rem;color:var(--text-dim);">No vendors in this category</div>';
    filtered.forEach(v => {
        const row = document.createElement('div');
        row.className = 'vendor-row';
        row.innerHTML = `<div class="vendor-icon-box" style="background:${v.bg}">${v.icon}</div><div class="vendor-info"><div class="vendor-name">${v.name}</div><div class="vendor-meta">${v.location} Â· ${v.jobs.length} open role${v.jobs.length!==1?'s':''}</div></div><div class="vendor-rating">${v.rating}</div>`;
        row.onclick = () => openVendorDetail(v);
        list.appendChild(row);
    });
}
function openVendorDetail(v) {
    document.getElementById('vendor-modal').classList.remove('open');
    document.getElementById('vd-icon').textContent = v.icon;
    document.getElementById('vd-icon').style.background = v.bg;
    document.getElementById('vd-name').textContent = v.name;
    document.getElementById('vd-category').textContent = v.cat.charAt(0).toUpperCase()+v.cat.slice(1)+' Â· '+v.rating;
    document.getElementById('vd-desc').textContent = v.desc;
    document.getElementById('vd-location').textContent = v.location;
    document.getElementById('vd-rating').textContent = v.rating;
    document.getElementById('vd-contact').textContent = v.contact;
    document.getElementById('vd-hours').textContent = v.hours;
    const jobsEl = document.getElementById('vd-jobs-list');
    jobsEl.innerHTML = '';
    v.jobs.forEach(j => {
        const item = document.createElement('div');
        item.className = 'action-row';
        item.style.cursor = 'pointer';
        const parts = j.split(' Â· ');
        item.innerHTML = `<div class="action-icon-wrap gold">ðŸ’¼</div><div class="action-text"><div class="action-label">${parts[0]}</div><div class="action-desc">${parts[1]||''}</div></div><span class="action-badge badge-gold">Apply</span>`;
        item.onclick = () => { closeSvcModal('vendor-detail-modal',null,true); openJobModal({title:parts[0],company:v.name,salary:parts[1]||'N/A',type:'Full-Time',location:v.location,exp:'Varies',desc:v.desc}); };
        jobsEl.appendChild(item);
    });
    document.getElementById('vd-jobs-section').style.display = 'block';
    document.getElementById('vendor-detail-modal').classList.add('open');
}
function contactVendor() { showToast('ðŸ“ž Connecting to '+document.getElementById('vd-name').textContent+'â€¦'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//              DOCUMENT VAULT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const defaultVaultDocs = [
    { type:'National ID', name:'NRC Â· Zambia 2019', date:'12 Jan 2024', icon:'ðŸªª' },
    { type:'PSV Licence', name:'PSV Driver Licence', date:'03 Mar 2024', icon:'ðŸš—' },
    { type:'Employment Contract', name:'PU Contract 2024', date:'15 May 2024', icon:'ðŸ“‹' },
];
let vaultDocs = [...defaultVaultDocs];

function openDocVault() {
    renderVaultDocs();
    document.getElementById('vault-doc-name').value = '';
    document.getElementById('trust-modal').classList.remove('open');
    document.getElementById('vault-modal').classList.add('open');
}
function renderVaultDocs() {
    const list = document.getElementById('vault-list');
    if (!list) return;
    list.innerHTML = '';
    if (!vaultDocs.length) { list.innerHTML = '<div style="text-align:center;padding:16px;font-size:0.8rem;color:var(--text-dim);">No documents stored yet</div>'; return; }
    vaultDocs.forEach((doc, idx) => {
        const item = document.createElement('div');
        item.className = 'vault-item';
        item.innerHTML = `<div class="vault-item-icon">${doc.icon}</div><div class="vault-item-info"><div class="vault-item-name">${doc.name}</div><div class="vault-item-meta">${doc.type} Â· Uploaded ${doc.date}</div></div><span class="vault-item-badge">âœ“ Verified</span><button class="vault-delete" onclick="deleteVaultDoc(${idx})">ðŸ—‘</button>`;
        list.appendChild(item);
    });
    updateVaultDesc();
}
function uploadVaultDoc() {
    const type = document.getElementById('vault-doc-type').value;
    const name = document.getElementById('vault-doc-name').value.trim();
    if (!name) { showToast('Please enter a document name'); return; }
    const icons = {'National ID':'ðŸªª','PSV Licence':'ðŸš—','Employment Contract':'ðŸ“‹','Pay Slip':'ðŸ’µ','Insurance Certificate':'ðŸ›¡ï¸','Vehicle Registration':'ðŸš™','Other':'ðŸ“„'};
    const today = new Date().toLocaleDateString('en-GB',{day:'2-digit',month:'short',year:'numeric'});
    vaultDocs.unshift({type, name, date:today, icon:icons[type]||'ðŸ“„'});
    document.getElementById('vault-doc-name').value = '';
    renderVaultDocs();
    showToast('âœ“ Document added to vault');
}
function deleteVaultDoc(idx) { vaultDocs.splice(idx,1); renderVaultDocs(); showToast('Document removed'); }
function updateVaultDesc() { const el=document.getElementById('vault-desc'); if(el) el.textContent = vaultDocs.length+' document'+(vaultDocs.length!==1?'s':'')+' stored securely'; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//           YELLOW VEST AMBASSADOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentAmbassador = {name:'Stella Achieng', initials:'SA'};
const ambassadorReplies = [
    "Hello! How can I help you today?",
    "I'm nearby â€” I can meet you at City Market in about 10 minutes.",
    "Sure, I can help with that. Can you describe the issue in more detail?",
    "No problem at all. I'll contact the relevant team on your behalf.",
    "Got it. I'm escalating this to our supervisor. You'll receive a callback within 1 hour.",
    "Your case has been logged. A reference number will be sent to your phone shortly.",
    "Is there anything else I can assist you with today?",
];
let ambReplyIdx = 0;

function openAmbassadorModal() {
    document.getElementById('trust-modal').classList.remove('open');
    document.getElementById('amb-chat-section').style.display = 'none';
    ambReplyIdx = 0;
    document.getElementById('ambassador-modal').classList.add('open');
}
function callAmbassador() {
    showToast('ðŸ“ž Calling Stella Achiengâ€¦ +260 97 044 1122');
    addActivity('ðŸ“ž','Called Yellow Vest Ambassador','Stella Achieng Â· City Market Zone','orange');
}
function selectAmbassador(initials, name, zone, dist) {
    currentAmbassador = {name, initials};
    showToast('Connecting to '+name+'â€¦');
    setTimeout(() => {
        openAmbassadorChat();
        document.getElementById('amb-chat-log').innerHTML = `<div class="chat-msg amb"><div class="chat-sender">${name}</div><div class="chat-bubble">Hi there! I'm ${name} from the ${zone}. How can I help?</div></div>`;
    }, 600);
}
function openAmbassadorChat() {
    const s = document.getElementById('amb-chat-section');
    s.style.display = 'block';
    setTimeout(()=>s.scrollIntoView({behavior:'smooth',block:'nearest'}),100);
}
function sendAmbMsg() {
    const input = document.getElementById('amb-msg-input');
    const msg = input.value.trim();
    if (!msg) return;
    const log = document.getElementById('amb-chat-log');
    const userEl = document.createElement('div');
    userEl.className = 'chat-msg user';
    userEl.innerHTML = `<div class="chat-sender">You</div><div class="chat-bubble">${msg}</div>`;
    log.appendChild(userEl);
    input.value = '';
    log.scrollTop = log.scrollHeight;
    const typingEl = document.createElement('div');
    typingEl.className = 'chat-msg amb';
    typingEl.innerHTML = `<div class="chat-sender">${currentAmbassador.name}</div><div class="chat-bubble" style="color:var(--text-dim);">typingâ€¦</div>`;
    log.appendChild(typingEl);
    log.scrollTop = log.scrollHeight;
    setTimeout(() => {
        const reply = ambassadorReplies[ambReplyIdx % ambassadorReplies.length];
        ambReplyIdx++;
        typingEl.innerHTML = `<div class="chat-sender">${currentAmbassador.name}</div><div class="chat-bubble">${reply}</div>`;
        log.scrollTop = log.scrollHeight;
    }, 1000 + Math.random()*800);
}
</script>
</body>
</html>
